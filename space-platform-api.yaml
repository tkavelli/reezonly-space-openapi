openapi: 3.1.0
info:
  title: Reezonly Space Platform API
  version: 1.0.0
  description: |
    **Руководство интеграций Reezonly Space** — это главный источник информации, благодаря которому внешние CRM, CMS, ERP и маркетинговые системы быстро подключают программный доступ к Space API.

    Здесь собраны схемы аутентификации, бизнес‑блоки пользователей, групп, курсов, сертификатов и отчетов, примеры запросов и схемы ответов. Документация рассказывает, как синхронизировать пользователей, подтянуть группы и права из вашей CRM, создавать курсы и выгружать отчеты — все через безопасный `X-API-Key` и понятные бизнес-сущности.

    ## Обзор платформы

    - **Управление пользователями** — группы с вложенностью, сегментация, импорт, лимиты
    - **CMS** — конструктор лендингов, страниц, меню, SEO
    - **Платёжный шлюз** — приём платежей (ЮMoney, Robokassa)
    - **Маркетинг** — email-рассылки (13 системных событий), формы, wait-list
    - **Сертификаты** — генерация PDF-документов
    - **Каталог курсов** — витрина (контент курсов в LMS)
    - **Интеграция с LMS** — iframe, webhook, API для курсов

    ## Аутентификация

    Для доступа к API необходимо использовать **API Key** в заголовке запроса:

    ```
    X-API-Key: your_api_key_here
    ```

    ## Базовый URL

    ```
    https://your-space-domain.com/api/v1
    ```
servers:
  - url: https://your-space-domain.com/api/v1
    description: Production server
  - url: https://staging-space-domain.com/api/v1
    description: Staging server
  - url: http://localhost:8080/api/v1
    description: Development server
security:
  - ApiKeyAuth: []
tags:
  - name: Users.Operations
    description: |
      ## Операции с пользователями

      **Назначение:** централизованно создать, прочитать, обновить и удалить пользователей, сохраняя синхронизацию с LMS и бизнес-ролями.
      **Ключевые особенности:**
      - Протоколированная магистраль CRUD по `X-API-Key` с фильтрами/пагинацией.
      - Полный сет схем `SuccessResponse`, `BadRequest`, `Forbidden`, `NotFound`, и `User`.
      - Поддержка массовых операций (`delete?ids[]=`) и отдельных просмотров.
      **Пример Use case:** интегратор CRM запрашивает `/user/user/index` для списка, показывает карточку и вызывает `PUT /user/user/update`, чтобы синхронно обновить кастомные поля и статусы.
  - name: Users.Courses
    description: |
      ## Управление доступом пользователей к курсам

      **Назначение:** быстро назначать/отзывать доступ к курсам из внешней LMS/CRM.
      **Ключевые особенности:** набор `POST /add-course`/`POST /delete-course` с телом `user_id` + `course_ids`, проверка доступности и массовые обновления.
      **Пример Use case:** маркетолог настраивает доступ студентов к новому продукту: сначала назначает нужный набор курсов, затем отзывает старые.
  - name: Users.Import
    description: |
      ## Импорт пользователей

      **Назначение:** загружать сотни пользователей и отслеживать прогресс асинхронно.
      **Ключевые особенности:** предварительный `preview` (multipart с шаблоном), `load` создаёт задачу, `get-import-progress` возвращает `ImportStatus`, дополнительные отчёты XLSX.
      **Пример Use case:** после оплаты клиент загружает Excel, смотрит превью, запускает импорт и регулярно проверяет статус, пока не получит финальный файл через `/user/importreport/download`.
  - name: Users.Fields
    description: |
      ## Кастомные поля пользователей

      **Назначение:** предоставлять актуальные метаданные профиля (customer attributes, achievements, tokens).
      **Ключевые особенности:** простой список полей `/dictionary/user/fields`, возвращаемая схема `UserField`.
      **Пример Use case:** мобильное приложение запрашивает доступные поля, чтобы показать динамическую форму регистрации с нужными полями и валидацией.
  - name: Groups.Structure
    description: |
      ## Структура и иерархия групп

      **Назначение:** выстроить иерархию корпоративных групп с поддержкой вложенности, фильтрации и синхронизации с продуктами/ролями.
      **Ключевые особенности:**
      - Родительские связи, проверка циклов, фильтры по статусу/group type и `PaginationMeta`.
      - Используются схемы `Group`, `GroupListItem` и стандартные ответы на ошибки.
      **Пример Use case:** интегратор CRM подстраивает дерево отделов: получает групповой каталог, создаёт новый подраздел с `POST /group/group/create`, затем проверяет структуру через `/group/group/view`.
  - name: Groups.Members
    description: |
      ## Управление участниками групп

      **Назначение:** массово добавлять/удалять пользователей и назначать курсы для групп на стороне интеграции.
      **Ключевые особенности:** простые payload’ы (`user_id`, `course_ids`, списки `ids[]`), поддержка экспорта, `assign-courses` для курсов, `DELETE /multiple-delete`.
      **Пример Use case:** HR переносит 50 сотрудников между группами, одновременно обновляя назначенные курсы через `POST /group/group/assign-courses`, а затем скачивает экспорт структуры (`/group/group/export`).
  - name: Certificates.Templates
    description: |
      Управление шаблонами для генерации PDF сертификатов: внешний вид, расположение элементов и переменные для подстановки данных (read-only).
  - name: Certificates.Issued
    description: |
      Управление выданными сертификатами, их статусами и верификацией.
  - name: Certificates.Lookups
    description: |
      Справочники и системные настройки, связанные с сертификатами.
  - name: Courses
    description: |
      ## Курсы и обучающие продукты (только чтение)

      **Назначение:** предоставить актуальные метаданные курсов и продуктов для внешних витрин, маркетинговых страниц и CRM.
      **Ключевые особенности:** постраничная выдача (`/course/course/index`), подробные описания структуры и уроков, атрибуты активности (`students_count`, `enabled`, `status`, `picture`, `lms_id`).
      **Пример Use case:** маркетинговая команда из внешнего CMS подгружает `/course/course/index`, показывает список продуктов с картинками и вызывает `/course/course/view` для раскрытия программы и уроков.
  - name: Pages
    description: |
      ## Страницы и контент сайта (только чтение)

      **Назначение:** раскрыть структуру публичных и закрытых страниц сайта, чтобы сторонние CMS могли отображать лендинги и меню.
      **Ключевые особенности:** подробный список типов страниц (`/dictionary/dictionary/page-types`), фильтруемая выдача `pages`, статус `enabled`, SEO-метаданные, `alias` и `category`.
      **Пример Use case:** внешняя система заимствует SPA-меню, вызывает `/dictionary/dictionary/pages`, сортирует по типу и обновляет ссылки на новом сайте без доступа к внутреннему CMS.
  - name: Integration Reports
    description: |
      ## Отчеты для интеграционных систем

      Генерация данных «Сводного» отчёта в JSON для BI/дашбордов без генерации файлов.
paths:
  /user/user/index:
    get:
      tags:
        - Users.Operations
      operationId: listUsers
      summary: Получить список всех пользователей
      description: Возвращает список всех пользователей с фильтрацией, сортировкой и пагинацией
      parameters:
        - in: query
          name: page
          description: Номер страницы для пагинации
          required: false
          schema:
            type: integer
            minimum: 1
            default: 1
            example: 1
        - in: query
          name: per-page
          description: Количество элементов на странице (максимум 100)
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
            example: 50
        - in: query
          name: search
          description: Поисковый запрос для фильтрации результатов
          required: false
          schema:
            type: string
            example: ivan
      responses:
        '200':
          description: Список пользователей успешно получен
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      success:
                        type: boolean
                        example: true
                      meta:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: Общее количество элементов
                            example: 150
                          page:
                            type: integer
                            description: Текущая страница
                            example: 1
                          per-page:
                            type: integer
                            description: Элементов на странице
                            example: 20
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          pagination:
                            type: object
                            properties:
                              total:
                                type: integer
                                description: Общее количество элементов
                                example: 150
                              page:
                                type: integer
                                description: Текущая страница
                                example: 1
                              per-page:
                                type: integer
                                description: Элементов на странице
                                example: 20
                          items:
                            type: array
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  example: 137
                                email:
                                  type: string
                                  format: email
                                  example: user@example.com
                                name:
                                  type: string
                                  example: Иван Иванов
                                role:
                                  type: string
                                  enum:
                                    - admin
                                    - editor
                                    - curator
                                    - student
                                  x-enumDescriptions:
                                    admin: Администратор (полный доступ)
                                    editor: Контент-редактор
                                    curator: Куратор/методист
                                    student: Ученик/слушатель
                                  example: student
                                status:
                                  type: string
                                  enum:
                                    - active
                                    - inactive
                                    - blocked
                                  x-enumDescriptions:
                                    active: Активный пользователь
                                    inactive: Неактивный (архив/черновик)
                                    blocked: Заблокирован (без доступа)
                                  example: active
                                created_at:
                                  type: string
                                  format: date-time
                                  example: '2024-01-15T10:30:00Z'
                                updated_at:
                                  type: string
                                  format: date-time
                                  example: '2024-01-15T10:30:00Z'
              examples:
                default:
                  summary: Пагинированный список пользователей
                  value:
                    success: true
                    data:
                      pagination:
                        total: 1520
                        page: 1
                        per_page: 20
                      items:
                        - id: 137
                          email: user@example.com
                          username: Иван Иванов
                          role: student
                          status: active
                          created_at: '2024-01-15T10:30:00Z'
                          updated_at: '2024-02-01T09:10:00Z'
                        - id: 138
                          email: admin@example.com
                          username: Мария Админова
                          role: admin
                          status: active
                          created_at: '2024-01-12T08:00:00Z'
                          updated_at: '2024-02-02T12:00:00Z'
        '400':
          description: Ошибка в запросе (неверные параметры)
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  email:
                    - Некорректный email
                  page:
                    - page must be >= 1
  /user/user/admin:
    get:
      tags:
        - Users.Operations
      operationId: listAdminUsers
      summary: Получить список администраторов
      description: Возвращает список всех пользователей с правами администратора
      parameters:
        - in: query
          name: page
          description: Номер страницы для пагинации
          required: false
          schema:
            type: integer
            minimum: 1
            default: 1
            example: 1
        - in: query
          name: per-page
          description: Количество элементов на странице (максимум 100)
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
            example: 50
      responses:
        '200':
          description: Список администраторов успешно получен
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      success:
                        type: boolean
                        example: true
                      meta:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: Общее количество элементов
                            example: 150
                          page:
                            type: integer
                            description: Текущая страница
                            example: 1
                          per-page:
                            type: integer
                            description: Элементов на странице
                            example: 20
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          pagination:
                            type: object
                            properties:
                              total:
                                type: integer
                                description: Общее количество элементов
                                example: 150
                              page:
                                type: integer
                                description: Текущая страница
                                example: 1
                              per-page:
                                type: integer
                                description: Элементов на странице
                                example: 20
                          items:
                            type: array
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  example: 137
                                email:
                                  type: string
                                  format: email
                                  example: user@example.com
                                name:
                                  type: string
                                  example: Иван Иванов
                                role:
                                  type: string
                                  enum:
                                    - admin
                                    - editor
                                    - curator
                                    - student
                                  x-enumDescriptions:
                                    admin: Администратор (полный доступ)
                                    editor: Контент-редактор
                                    curator: Куратор/методист
                                    student: Ученик/слушатель
                                  example: student
                                status:
                                  type: string
                                  enum:
                                    - active
                                    - inactive
                                    - blocked
                                  x-enumDescriptions:
                                    active: Активный пользователь
                                    inactive: Неактивный (архив/черновик)
                                    blocked: Заблокирован (без доступа)
                                  example: active
                                created_at:
                                  type: string
                                  format: date-time
                                  example: '2024-01-15T10:30:00Z'
                                updated_at:
                                  type: string
                                  format: date-time
                                  example: '2024-01-15T10:30:00Z'
              examples:
                default:
                  summary: Только пользователи с ролями админа
                  value:
                    success: true
                    data:
                      pagination:
                        total: 2
                        page: 1
                        per_page: 50
                      items:
                        - id: 5
                          email: cto@example.com
                          username: Сергей Техдир
                          role: admin
                          status: active
                          created_at: '2023-10-10T07:00:00Z'
                          updated_at: '2024-02-02T11:00:00Z'
                        - id: 7
                          email: owner@example.com
                          username: Анна Владельцева
                          role: admin
                          status: active
                          created_at: '2023-09-01T09:30:00Z'
                          updated_at: '2024-02-03T09:15:00Z'
        '400':
          description: Ошибка в запросе (неверные параметры)
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  email:
                    - Некорректный email
                  page:
                    - page must be >= 1
        '403':
          description: Доступ запрещен (недостаточно прав)
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  access:
                    - Недостаточно прав для выполнения операции
  /user/user/view:
    get:
      tags:
        - Users.Operations
      operationId: getUser
      summary: Получить детальную информацию о пользователе
      description: Возвращает полную информацию о пользователе включая его группы, курсы и кастомные поля
      parameters:
        - in: query
          name: id
          description: Идентификатор ресурса
          required: true
          schema:
            type: integer
            minimum: 1
            example: 42
      responses:
        '200':
          description: Успешно получена информация о пользователе
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      success:
                        type: boolean
                        example: true
                      meta:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: Общее количество элементов
                            example: 150
                          page:
                            type: integer
                            description: Текущая страница
                            example: 1
                          per-page:
                            type: integer
                            description: Элементов на странице
                            example: 20
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          item:
                            type: object
                            properties:
                              id:
                                type: integer
                                example: 137
                              email:
                                type: string
                                format: email
                                example: user@example.com
                              name:
                                type: string
                                example: Иван Иванов
                              role:
                                type: string
                                enum:
                                  - admin
                                  - editor
                                  - curator
                                  - student
                                x-enumDescriptions:
                                  admin: Администратор (полный доступ)
                                  editor: Контент-редактор
                                  curator: Куратор/методист
                                  student: Ученик/слушатель
                                example: student
                              status:
                                type: string
                                enum:
                                  - active
                                  - inactive
                                  - blocked
                                x-enumDescriptions:
                                  active: Активный пользователь
                                  inactive: Неактивный (архив/черновик)
                                  blocked: Заблокирован (без доступа)
                                example: active
                              created_at:
                                type: string
                                format: date-time
                                example: '2024-01-15T10:30:00Z'
                              updated_at:
                                type: string
                                format: date-time
                                example: '2024-01-15T10:30:00Z'
              examples:
                default:
                  summary: Карточка пользователя с группами и курсами
                  value:
                    success: true
                    data:
                      item:
                        id: 137
                        username: Иван Иванов
                        email: user@example.com
                        role: student
                        status: active
                        department: Продажи
                        position: Менеджер
                        custom_fields:
                          city: Москва
                          experience_years: 3
                        groups:
                          - id: 12
                            name: Sales / B2B
                          - id: 18
                            name: Москва
                        courses:
                          - id: 501
                            title: Онбординг
                          - id: 502
                            title: CRM Advanced
                        created_at: '2024-01-15T10:30:00Z'
                        updated_at: '2024-02-01T09:10:00Z'
        '404':
          description: Ресурс не найден
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  id:
                    - Ресурс не найден
  /dictionary/user/fields:
    get:
      tags:
        - Users.Fields
      operationId: listUserFields
      summary: Получить список кастомных полей пользователя
      description: Возвращает все доступные кастомные поля профилей пользователей
      responses:
        '200':
          description: Успешно получен список кастомных полей
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      success:
                        type: boolean
                        example: true
                      meta:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: Общее количество элементов
                            example: 150
                          page:
                            type: integer
                            description: Текущая страница
                            example: 1
                          per-page:
                            type: integer
                            description: Элементов на странице
                            example: 20
                  - type: object
                    properties:
                      items:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              description: ID поля
                              example: 789
                            name:
                              type: string
                              description: Имя поля (system name)
                              example: experience_years
                            label:
                              type: string
                              description: Отображаемое название поля
                              example: Опыт работы (лет)
                            type:
                              type: string
                              enum:
                                - string
                                - number
                                - date
                                - boolean
                                - select
                              description: Тип поля
                              example: number
                            required:
                              type: boolean
                              description: Обязательное ли поле
                              example: false
                            enabled:
                              type: boolean
                              description: Активно ли поле
                              example: true
                            validation_rules:
                              type: object
                              description: Правила валидации
                              example:
                                min: 0
                                max: 50
                            options:
                              type: array
                              items:
                                type: string
                              description: Варианты для select полей
                              example:
                                - 0-1
                                - 2-5
                                - 6-10
                                - 10+
              examples:
                default:
                  summary: Справочник пользовательских полей
                  value:
                    success: true
                    items:
                      - id: 789
                        name: experience_years
                        label: Опыт работы (лет)
                        type: number
                        required: false
                        enabled: true
                        validation_rules:
                          min: 0
                          max: 50
                        options: []
                      - id: 790
                        name: city
                        label: Город
                        type: string
                        required: false
                        enabled: true
                        validation_rules: {}
                        options: []
        '400':
          description: Ошибка в запросе (неверные параметры)
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  email:
                    - Некорректный email
                  page:
                    - page must be >= 1
        '403':
          description: Доступ запрещен (недостаточно прав)
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  access:
                    - Недостаточно прав для выполнения операции
  /user/user/create:
    post:
      tags:
        - Users.Operations
      operationId: createUser
      summary: Создать нового пользователя
      description: |
        Создает нового пользователя в системе с возможностью назначения роли.
        Автоматически синхронизирует пользователя с LMS и отправляет уведомления.

        **Валидация:**
        - Email должен быть уникальным в системе
        - Username обязателен, минимальная длина 2 символа, максимальная 255
        - Роль должна существовать в системе (не из списка RESTRICTED_ROLES)
        - Проверяется лимит пользователей тарифа

        **Бизнес-логика:**
        - При создании администратора отправляется email с паролем
        - Для обычных пользователей также отправляется уведомление
        - Автоматическая синхронизация с LMS через очередь
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              allOf:
                - type: object
                  required:
                    - username
                    - email
                  properties:
                    username:
                      type: string
                      minLength: 2
                      maxLength: 255
                      description: |
                        Имя пользователя. Обязательное поле.
                        - Минимум 2 символа
                        - Максимум 255 символов
                        - Trim automatically applied
                      example: Иван Петров
                    email:
                      type: string
                      format: email
                      description: |
                        Email пользователя. Должен быть уникальным в системе.
                        - Trim automatically applied
                        - Valid email format required
                      example: ivan.petrov@example.com
                    password:
                      type: string
                      description: |
                        Пароль пользователя. Если не указан, генерируется автоматически.
                        - Для существующих сотрудников не требуется
                        - Для новых пользователей рекомендуется задавать
                      example: SecurePassword123!
                    role:
                      type: string
                      description: |
                        Роль пользователя в системе. По умолчанию 'user'.
                        - Не может быть из списка RESTRICTED_ROLES
                        - Доступные роли: superadmin, admin, editor, curator, student
                      example: student
                      enum:
                        - superadmin
                        - admin
                        - editor
                        - curator
                        - student
                    department:
                      type: string
                      description: |
                        Отдел пользователя. Синхронизируется с LMS.
                      example: IT отдел
                    position:
                      type: string
                      description: |
                        Должность пользователя. Синхронизируется с LMS.
                      example: Разработчик
                    phone:
                      type: string
                      description: |
                        Телефон пользователя
                      example: +7 (999) 123-45-67
                    custom_fields:
                      type: object
                      description: |
                        Дополнительные поля пользователя (custom fields)
                        Ключи - это имена полей, значения - данные
                      example:
                        city: Москва
                        experience: 5 лет
                        skills:
                          - PHP
                          - JavaScript
                          - MySQL
                    group_ids:
                      type: array
                      description: Список идентификаторов групп, к которым добавляется пользователь
                      items:
                        type: integer
                        minimum: 1
                      example:
                        - 12
                        - 34
                    course_ids:
                      type: array
                      description: Список идентификаторов курсов для назначения
                      items:
                        type: integer
                        minimum: 1
                      example:
                        - 501
                        - 502
                - type: object
                  properties:
                    id:
                      type: integer
                      minimum: 1
                      example: 101
                      description: ID пользователя (только для update)
                    avatar:
                      type: string
                      format: binary
                      description: Аватар пользователя (опционально)
            examples:
              basic_user:
                summary: Создание обычного пользователя
                value:
                  username: Иван Петров
                  email: ivan.petrov@example.com
                  department: IT отдел
                  position: Разработчик
              admin_user:
                summary: Создание администратора
                value:
                  username: Мария Сидорова
                  email: maria.sidorова@example.com
                  role: admin
                  password: SecurePassword123!
      responses:
        '201':
          description: Пользователь успешно создан
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      success:
                        type: boolean
                        example: true
                      meta:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: Общее количество элементов
                            example: 150
                          page:
                            type: integer
                            description: Текущая страница
                            example: 1
                          per-page:
                            type: integer
                            description: Элементов на странице
                            example: 20
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          user_id:
                            type: integer
                            example: 123
              examples:
                user_created:
                  summary: Пользователь создан
                  value:
                    success: true
                    data:
                      user_id: 123
        '400':
          description: Ошибка валидации
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              examples:
                validation_error:
                  summary: Ошибка валидации email
                  value:
                    success: false
                    errors:
                      email:
                        - Email адрес уже занят
                user_limit_error:
                  summary: Достигнут лимит пользователей
                  value:
                    success: false
                    errors:
                      username:
                        - New user registration is not available
        '403':
          description: Недостаточно прав для создания пользователя
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  permission:
                    - Insufficient permissions
  /user/user/update:
    put:
      tags:
        - Users.Operations
      operationId: updateUser
      summary: Обновить данные пользователя
      description: Обновляет информацию о существующем пользователе
      parameters:
        - in: query
          name: id
          description: Идентификатор ресурса
          required: true
          schema:
            type: integer
            minimum: 1
            example: 42
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              allOf:
                - type: object
                  required:
                    - username
                    - email
                  properties:
                    username:
                      type: string
                      minLength: 2
                      maxLength: 255
                      description: |
                        Имя пользователя. Обязательное поле.
                        - Минимум 2 символа
                        - Максимум 255 символов
                        - Trim automatically applied
                      example: Иван Петров
                    email:
                      type: string
                      format: email
                      description: |
                        Email пользователя. Должен быть уникальным в системе.
                        - Trim automatically applied
                        - Valid email format required
                      example: ivan.petrov@example.com
                    password:
                      type: string
                      description: |
                        Пароль пользователя. Если не указан, генерируется автоматически.
                        - Для существующих сотрудников не требуется
                        - Для новых пользователей рекомендуется задавать
                      example: SecurePassword123!
                    role:
                      type: string
                      description: |
                        Роль пользователя в системе. По умолчанию 'user'.
                        - Не может быть из списка RESTRICTED_ROLES
                        - Доступные роли: superadmin, admin, editor, curator, student
                      example: student
                      enum:
                        - superadmin
                        - admin
                        - editor
                        - curator
                        - student
                    department:
                      type: string
                      description: |
                        Отдел пользователя. Синхронизируется с LMS.
                      example: IT отдел
                    position:
                      type: string
                      description: |
                        Должность пользователя. Синхронизируется с LMS.
                      example: Разработчик
                    phone:
                      type: string
                      description: |
                        Телефон пользователя
                      example: +7 (999) 123-45-67
                    custom_fields:
                      type: object
                      description: |
                        Дополнительные поля пользователя (custom fields)
                        Ключи - это имена полей, значения - данные
                      example:
                        city: Москва
                        experience: 5 лет
                        skills:
                          - PHP
                          - JavaScript
                          - MySQL
                    group_ids:
                      type: array
                      description: Список идентификаторов групп, к которым добавляется пользователь
                      items:
                        type: integer
                        minimum: 1
                      example:
                        - 12
                        - 34
                    course_ids:
                      type: array
                      description: Список идентификаторов курсов для назначения
                      items:
                        type: integer
                        minimum: 1
                      example:
                        - 501
                        - 502
                - type: object
                  properties:
                    id:
                      type: integer
                      minimum: 1
                      example: 101
                      description: ID пользователя (только для update)
                    avatar:
                      type: string
                      format: binary
                      description: Аватар пользователя (опционально)
            examples:
              update_profile:
                summary: Обновление профиля и статуса
                value:
                  username: Ирина Климова
                  status: active
                  role: editor
                  department: Маркетинг
                  position: Контент-редактор
              update_memberships:
                summary: Обновление групп и курсов
                value:
                  group_ids:
                    - 12
                    - 18
                  course_ids:
                    - 501
                    - 550
      responses:
        '200':
          description: Пользователь обновлён
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      success:
                        type: boolean
                        example: true
                      meta:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: Общее количество элементов
                            example: 150
                          page:
                            type: integer
                            description: Текущая страница
                            example: 1
                          per-page:
                            type: integer
                            description: Элементов на странице
                            example: 20
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          user_id:
                            type: integer
                            example: 123
              examples:
                updated:
                  summary: Обновление роли и статуса
                  value:
                    success: true
                    data:
                      user_id: 123
        '400':
          description: Ошибка валидации данных
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  password:
                    - Password must be at least 6 characters
        '404':
          description: Ресурс не найден
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  id:
                    - Ресурс не найден
  /user/user/delete:
    delete:
      tags:
        - Users.Operations
      operationId: deleteUser
      summary: Удалить пользователей
      description: Удаляет одного или нескольких пользователей
      parameters:
        - in: query
          name: ids[]
          description: Массив идентификаторов для массовых операций (максимум 100 элементов)
          required: true
          schema:
            type: array
            items:
              type: integer
              minimum: 1
            maxItems: 100
            example:
              - 12
              - 15
              - 20
      responses:
        '200':
          description: Пользователь(и) удалены
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  meta:
                    type: object
                    properties:
                      total:
                        type: integer
                        description: Общее количество элементов
                        example: 150
                      page:
                        type: integer
                        description: Текущая страница
                        example: 1
                      per-page:
                        type: integer
                        description: Элементов на странице
                        example: 20
              examples:
                bulk_delete:
                  summary: Удалено несколько пользователей
                  value:
                    success: true
        '400':
          description: Ошибка в запросе (неверные параметры)
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  email:
                    - Некорректный email
                  page:
                    - page must be >= 1
  /dictionary/user/statuses:
    get:
      tags:
        - Users.Operations
      operationId: listUserStatuses
      summary: Получить расширенные статусы пользователей
      description: Возвращает все возможные статусы пользователей в системе
      responses:
        '200':
          description: Успешно получен список статусов пользователей
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      success:
                        type: boolean
                        example: true
                      meta:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: Общее количество элементов
                            example: 150
                          page:
                            type: integer
                            description: Текущая страница
                            example: 1
                          per-page:
                            type: integer
                            description: Элементов на странице
                            example: 20
                  - type: object
                    properties:
                      items:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: string
                              description: Системный код статуса
                              example: active
                            name:
                              type: string
                              description: Отображаемое название статуса
                              example: Активный
                            description:
                              type: string
                              description: Расширенное описание статуса
                              example: Пользователь с активной учётной записью
                            category:
                              type: string
                              description: Группа статусов (например, access, pending, blocked)
                              example: access
                            color:
                              type: string
                              description: Цветовой код статуса (hex)
                              example: '#2ea44f'
                            is_default:
                              type: boolean
                              description: Является ли статус статусом по умолчанию при создании
                              example: true
                          example:
                            id: active
                            name: Активный
                            description: Пользователь с полной активной учётной записью
                            category: access
                            color: '#2ea44f'
                            is_default: true
              examples:
                default:
                  summary: Справочник статусов
                  value:
                    success: true
                    items:
                      - id: active
                        name: Активный
                        description: Полный доступ к платформе
                        category: access
                        color: '#2ea44f'
                        is_default: true
                      - id: inactive
                        name: Неактивный
                        description: Нет доступа, архив
                        category: access
                        color: '#9ca3af'
                        is_default: false
                      - id: blocked
                        name: Заблокирован
                        description: Доступ закрыт администратором
                        category: blocked
                        color: '#ef4444'
                        is_default: false
        '400':
          description: Ошибка в запросе (неверные параметры)
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  email:
                    - Некорректный email
                  page:
                    - page must be >= 1
        '403':
          description: Доступ запрещен (недостаточно прав)
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  access:
                    - Недостаточно прав для выполнения операции
  /user/user/add-course:
    post:
      tags:
        - Users.Courses
      operationId: assignUserCourse
      summary: Назначить курсы пользователям
      description: Массово назначает курсы списку пользователей
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - userIds
                - courses
              properties:
                userIds:
                  type: array
                  minItems: 1
                  items:
                    type: integer
                    minimum: 1
                  description: Список ID пользователей для назначения
                  example:
                    - 123
                    - 124
                courses:
                  type: array
                  minItems: 1
                  items:
                    type: object
                    required:
                      - id
                    properties:
                      id:
                        type: integer
                        minimum: 1
                        description: ID курса
                        example: 501
                      learning_group_id:
                        type: integer
                        minimum: 1
                        description: ID учебной группы (если назначается в конкретную группу)
                        example: 10
                      group_name:
                        type: string
                        description: Название группы, если группы ещё нет
                        example: Support
                  description: Список курсов для назначения, с опциональной привязкой к учебной группе или имени группы
            examples:
              assign_courses:
                summary: Массовое назначение курсов двум пользователям
                value:
                  userIds:
                    - 123
                    - 124
                  courses:
                    - id: 501
                      learning_group_id: 10
                    - id: 550
                      group_name: Support
      responses:
        '200':
          description: Курсы назначены
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  results:
                    type: array
                    description: Результат по каждому назначению
                    items:
                      type: object
                      properties:
                        userId:
                          type: integer
                          example: 501
                        courseId:
                          type: integer
                          example: 901
                        result:
                          type: boolean
                          example: true
                        new:
                          type: boolean
                          example: false
              examples:
                assigned:
                  summary: Успешное назначение
                  value:
                    success: true
                    results:
                      - userId: 123
                        courseId: 501
                        result: true
                        new: true
                      - userId: 124
                        courseId: 550
                        result: true
                        new: false
        '400':
          description: Ошибка в запросе (неверные параметры)
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  email:
                    - Некорректный email
                  page:
                    - page must be >= 1
  /user/user/delete-course:
    post:
      tags:
        - Users.Courses
      operationId: deleteUserCourse
      summary: Отозвать доступ к курсам у пользователей
      description: Массово отзывает доступ к курсам у списка пользователей
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - userIds
                - courses
              properties:
                userIds:
                  type: array
                  minItems: 1
                  items:
                    type: integer
                    minimum: 1
                  description: Список ID пользователей для отзыва
                  example:
                    - 123
                    - 124
                courses:
                  type: array
                  minItems: 1
                  items:
                    type: object
                    required:
                      - id
                    properties:
                      id:
                        type: integer
                        minimum: 1
                        description: ID курса
                        example: 501
                      learning_group_id:
                        type: integer
                        minimum: 1
                        description: ID учебной группы (если нужно отозвать только в группе)
                        example: 10
                      group_name:
                        type: string
                        description: Название группы, если отозвать по имени
                        example: Support
                  description: Список курсов для отзыва, с опциональной привязкой к учебной группе или имени группы
            examples:
              revoke_courses:
                summary: Отзыв курсов у нескольких пользователей
                value:
                  userIds:
                    - 123
                    - 124
                  courses:
                    - id: 501
                      learning_group_id: 10
                    - id: 550
                      group_name: Support
      responses:
        '200':
          description: Курсы отозваны
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  results:
                    oneOf:
                      - type: array
                        items:
                          type: object
                          properties:
                            userId:
                              type: integer
                              example: 501
                            courseId:
                              type: integer
                              example: 901
                            result:
                              type: boolean
                              example: true
                      - type: integer
                        description: Количество удалённых записей
              examples:
                revoked:
                  summary: Успешный отзыв
                  value:
                    success: true
                    results: 2
        '400':
          description: Ошибка в запросе (неверные параметры)
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  email:
                    - Некорректный email
                  page:
                    - page must be >= 1
  /user/user/preview:
    post:
      tags:
        - Users.Import
      operationId: getUserImportPreview
      summary: Предпросмотр импорта Excel-файла
      description: Анализирует Excel файл и показывает preview данных для импорта
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - fileImport
              properties:
                fileImport:
                  type: string
                  format: binary
                  description: Excel файл для импорта (.xlsx, .xls)
                updateMode:
                  type: boolean
                  description: Обновлять существующих пользователей
                  example: false
            examples:
              sample_file:
                summary: Excel с 3 пользователями
                value:
                  fileImport: data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,UEsDBBQA...
                  updateMode: false
      responses:
        '200':
          description: Успешно проанализирован файл
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      success:
                        type: boolean
                        example: true
                      meta:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: Общее количество элементов
                            example: 150
                          page:
                            type: integer
                            description: Текущая страница
                            example: 1
                          per-page:
                            type: integer
                            description: Элементов на странице
                            example: 20
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          preview:
                            type: object
              examples:
                preview_ok:
                  summary: Валидный файл, без ошибок
                  value:
                    success: true
                    data:
                      preview:
                        total_rows: 3
                        valid_rows: 3
                        errors: []
        '400':
          description: Ошибка в запросе (неверные параметры)
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  email:
                    - Некорректный email
                  page:
                    - page must be >= 1
  /user/user/load:
    post:
      tags:
        - Users.Import
      operationId: createUserImport
      summary: Запустить импорт пользователей (асинхронно)
      description: Запускает фоновый процесс импорта пользователей из Excel файла
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - fileImport
              properties:
                fileImport:
                  type: string
                  format: binary
                  description: Excel файл для импорта
                updateMode:
                  type: boolean
                  default: false
                  description: Обновлять существующих пользователей
                  example: true
            examples:
              start_import:
                summary: Импорт с обновлением существующих пользователей
                value:
                  fileImport: data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,UEsDBBQA...
                  updateMode: true
      responses:
        '200':
          description: Импорт успешно запущен
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      success:
                        type: boolean
                        example: true
                      meta:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: Общее количество элементов
                            example: 150
                          page:
                            type: integer
                            description: Текущая страница
                            example: 1
                          per-page:
                            type: integer
                            description: Элементов на странице
                            example: 20
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          jobId:
                            type: integer
                            example: 1201
                          reportKey:
                            type: string
                            example: import-users-2025-02-10.xlsx
              examples:
                import_started:
                  summary: Импорт принят и обрабатывается
                  value:
                    success: true
                    message: Commit job queued
                    data:
                      jobId: 1024
                      reportKey: imp-2025-02-10-001
        '400':
          description: Ошибка в запросе (неверные параметры)
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  email:
                    - Некорректный email
                  page:
                    - page must be >= 1
  /user/user/get-import-progress:
    get:
      tags:
        - Users.Import
      operationId: getUserImportProgress
      summary: Получить статус текущего импорта
      description: Возвращает текущий статус и прогресс импорта пользователей
      parameters:
        - name: id
          in: query
          required: true
          schema:
            type: string
            example: imp-2025-02-10-001
          description: ID импорта (из ответа метода load)
      responses:
        '200':
          description: Успешно получен статус импорта
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      success:
                        type: boolean
                        example: true
                      meta:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: Общее количество элементов
                            example: 150
                          page:
                            type: integer
                            description: Текущая страница
                            example: 1
                          per-page:
                            type: integer
                            description: Элементов на странице
                            example: 20
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          progress:
                            type: integer
                            description: Процент завершения импорта
                            example: 42
                          report:
                            oneOf:
                              - type: 'null'
                              - type: object
                                properties:
                                  successCount:
                                    type: integer
                                    example: 118
                                  errorCount:
                                    type: integer
                                    example: 2
              examples:
                in_progress:
                  summary: Импорт в процессе
                  value:
                    success: true
                    message: Processing
                    data:
                      progress: 42
                      report: null
                completed:
                  summary: Импорт завершён
                  value:
                    success: true
                    message: Completed
                    data:
                      progress: 100
                      report:
                        successCount: 118
                        errorCount: 2
        '400':
          description: Ошибка в запросе (неверные параметры)
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  email:
                    - Некорректный email
                  page:
                    - page must be >= 1
        '404':
          description: Ресурс не найден
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  id:
                    - Ресурс не найден
  /user/user/load-template:
    get:
      tags:
        - Users.Import
      operationId: downloadUserImportTemplate
      summary: Скачать шаблон Excel для импорта
      description: Возвращает Excel файл с шаблоном для импорта пользователей
      responses:
        '200':
          description: Успешно скачан файл шаблона
          content:
            application/vnd.openxmlformats-officedocument.spreadsheetml.sheet:
              schema:
                type: string
                format: binary
              examples:
                template:
                  summary: Excel-шаблон для импорта
                  value: UEsDBBQACAgI...
        '400':
          description: Ошибка в запросе (неверные параметры)
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  email:
                    - Некорректный email
                  page:
                    - page must be >= 1
        '404':
          description: Ресурс не найден
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  id:
                    - Ресурс не найден
  /user/import-report/index:
    get:
      tags:
        - Users.Import
      operationId: listUserImportReports
      summary: Получить список завершённых отчётов импорта
      description: Возвращает список всех завершенных отчётов импорта пользователей
      parameters:
        - in: query
          name: page
          description: Номер страницы для пагинации
          required: false
          schema:
            type: integer
            minimum: 1
            default: 1
            example: 1
        - in: query
          name: per-page
          description: Количество элементов на странице (максимум 100)
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
            example: 50
      responses:
        '200':
          description: Успешно получен список отчётов импорта
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      success:
                        type: boolean
                        example: true
                      meta:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: Общее количество элементов
                            example: 150
                          page:
                            type: integer
                            description: Текущая страница
                            example: 1
                          per-page:
                            type: integer
                            description: Элементов на странице
                            example: 20
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          pagination:
                            type: object
                            properties:
                              total:
                                type: integer
                                description: Общее количество элементов
                                example: 150
                              page:
                                type: integer
                                description: Текущая страница
                                example: 1
                              per-page:
                                type: integer
                                description: Элементов на странице
                                example: 20
                          items:
                            type: array
                            items:
                              type: object
                              description: Итоговый отчёт завершённого импорта пользователей
                              properties:
                                id:
                                  type: integer
                                  description: ID отчёта импорта
                                  example: 1201
                                file:
                                  type: string
                                  description: Имя исходного файла импорта
                                  example: import-users-2025-02-10.xlsx
                                status:
                                  type: string
                                  enum:
                                    - completed
                                    - failed
                                  description: Финальный статус задачи импорта
                                  example: completed
                                progress:
                                  type: integer
                                  minimum: 0
                                  maximum: 100
                                  description: Процент завершения задачи (всегда 100 для завершённых отчётов)
                                  example: 100
                                success_count:
                                  type: integer
                                  description: Количество успешно обработанных записей
                                  example: 118
                                error_count:
                                  type: integer
                                  description: Количество записей с ошибками
                                  example: 2
                                created_at:
                                  type: string
                                  format: date-time
                                  description: Дата создания задачи импорта
                                  example: '2025-02-10T10:00:00Z'
                                updated_at:
                                  type: string
                                  format: date-time
                                  description: Дата последнего обновления статуса задачи
                                  example: '2025-02-10T10:05:30Z'
              examples:
                reports:
                  summary: Последние отчёты
                  value:
                    success: true
                    data:
                      pagination:
                        total: 2
                        page: 1
                        per_page: 20
                      items:
                        - id: 1201
                          file: import-users-2025-02-10.xlsx
                          status: completed
                          progress: 100
                          success_count: 98
                          error_count: 2
                          created_at: '2025-02-10T10:00:00Z'
                          updated_at: '2025-02-10T10:05:30Z'
                        - id: 1190
                          file: import-users-2025-02-08.xlsx
                          status: failed
                          progress: 100
                          success_count: 0
                          error_count: 120
                          created_at: '2025-02-08T08:20:00Z'
                          updated_at: '2025-02-08T08:21:10Z'
        '400':
          description: Ошибка в запросе (неверные параметры)
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  email:
                    - Некорректный email
                  page:
                    - page must be >= 1
  /user/importreport/download:
    get:
      tags:
        - Users.Import
      operationId: downloadUserImportReport
      summary: Скачать XLSX с результатами импорта
      description: Возвращает Excel файл с детальными результатами импорта
      parameters:
        - in: query
          name: id
          description: Идентификатор ресурса
          required: true
          schema:
            type: integer
            minimum: 1
            example: 42
      responses:
        '200':
          description: Успешно скачан файл отчёта импорта
          content:
            application/vnd.openxmlformats-officedocument.spreadsheetml.sheet:
              schema:
                type: string
                format: binary
              examples:
                report_file:
                  summary: XLSX-отчёт об импорте
                  value: UEsDBBQACAgI...
        '404':
          description: Ресурс не найден
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  id:
                    - Ресурс не найден
  /group/group/index:
    get:
      tags:
        - Groups.Structure
      operationId: listGroups
      summary: Получить список групп с пагинацией и фильтрацией
      description: |
        Возвращает список групп с поддержкой пагинации, поиска и иерархической фильтрации.
        Можно фильтровать по родительской группе, искать по названию и описанию.
        Поддерживает сортировку по количеству пользователей и дате обновления.
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
          description: Номер страницы
          example: 1
        - name: per_page
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          description: Элементов на странице
          example: 20
        - name: parent_id
          in: query
          schema:
            type: integer
            minimum: 1
          description: ID родительской группы; если не указан — выводятся все корневые
          example: 10
        - name: search
          in: query
          schema:
            type: string
            maxLength: 255
          description: Поиск по названию или описанию группы
          example: Sales
        - name: sort
          in: query
          schema:
            type: string
            enum:
              - name
              - user_count
              - created_at
              - updated_at
            default: name
          description: Поле сортировки
          example: name
        - name: order
          in: query
          schema:
            type: string
            enum:
              - asc
              - desc
            default: asc
          description: Направление сортировки
          example: asc
        - name: include_default
          in: query
          schema:
            type: boolean
            default: false
          description: Включить системные группы по умолчанию
          example: false
      responses:
        '200':
          description: Успешный ответ с отфильтрованным списком групп
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      success:
                        type: boolean
                        example: true
                      meta:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: Общее количество элементов
                            example: 150
                          page:
                            type: integer
                            description: Текущая страница
                            example: 1
                          per-page:
                            type: integer
                            description: Элементов на странице
                            example: 20
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          items:
                            type: array
                            items:
                              allOf:
                                - type: object
                                  properties:
                                    id:
                                      type: integer
                                      description: Уникальный идентификатор группы
                                      example: 1
                                    name:
                                      type: string
                                      description: Название группы
                                      example: IT Department
                                    comment:
                                      type: string
                                      description: Описание группы
                                      example: Разработка и поддержка IT систем
                                    hierarchyPathString:
                                      type: string
                                      description: Полный иерархический путь группы
                                      example: Company / IT Department / Development Team
                                    userCount:
                                      type: integer
                                      description: Количество пользователей в группе
                                      example: 25
                                    type:
                                      type: integer
                                      description: Тип группы (1=гостевая, 2=авторизованных, 9=по умолчанию)
                                      example: 2
                                    parent_id:
                                      oneOf:
                                        - type: integer
                                          minimum: 1
                                        - type: 'null'
                                      description: ID родительской группы
                                      example: null
                                    image:
                                      oneOf:
                                        - type: string
                                          format: uri
                                        - type: 'null'
                                      description: URL изображения группы
                                      example: https://s3.reezonly.com/groups/it-dept.jpg
                                    created_at:
                                      type: string
                                      format: date-time
                                      description: Дата создания
                                      example: '2023-08-25T14:15:43Z'
                                    updated_at:
                                      type: string
                                      format: date-time
                                      description: Дата обновления
                                      example: '2023-08-25T14:15:43Z'
                                - type: object
                                  properties:
                                    parent:
                                      oneOf:
                                        - type: object
                                          description: Информация о родительской группе
                                          properties:
                                            id:
                                              type: integer
                                              example: 1
                                            name:
                                              type: string
                                              example: IT Department
                                        - type: 'null'
              examples:
                groups_list:
                  summary: Список групп с пагинацией
                  value:
                    success: true
                    data:
                      items:
                        - id: 1
                          name: IT Department
                          comment: Разработка и поддержка IT систем
                          hierarchyPathString: IT Department
                          userCount: 25
                          type: 2
                          image: https://s3.reezonly.com/groups/it-dept.jpg
                          created_at: '2023-08-25T14:15:43Z'
                          updated_at: '2023-08-25T14:15:43Z'
                        - id: 2
                          name: Development Team
                          comment: Frontend и backend разработка
                          hierarchyPathString: IT Department / Development Team
                          userCount: 15
                          type: 2
                          parent_id: 1
                          image: null
                          created_at: '2023-08-25T15:20:10Z'
                          updated_at: '2023-08-25T15:20:10Z'
        '400':
          description: Ошибка валидации данных
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  password:
                    - Password must be at least 6 characters
        '403':
          description: Доступ запрещен (недостаточно прав)
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  access:
                    - Недостаточно прав для выполнения операции
  /group/group/view:
    get:
      tags:
        - Groups.Structure
      operationId: getGroup
      summary: Получить детальную информацию о группе
      description: |
        Возвращает полную информацию о группе включая всех участников,
        дочерние группы и правила доступа. Используется для детального просмотра
        группы в административном интерфейсе.
      parameters:
        - name: id
          in: query
          required: true
          schema:
            type: integer
            minimum: 1
            example: 1
          description: ID группы
        - name: include_users
          in: query
          schema:
            type: boolean
            default: true
            example: true
          description: Включить список пользователей группы
        - name: include_children
          in: query
          schema:
            type: boolean
            default: true
            example: true
          description: Включить дочерние группы
        - name: users_page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
            example: 1
          description: Страница пользователей (при include_users=true)
      responses:
        '200':
          description: Детальная информация о группе
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      success:
                        type: boolean
                        example: true
                      meta:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: Общее количество элементов
                            example: 150
                          page:
                            type: integer
                            description: Текущая страница
                            example: 1
                          per-page:
                            type: integer
                            description: Элементов на странице
                            example: 20
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          item:
                            allOf:
                              - type: object
                                properties:
                                  id:
                                    type: integer
                                    description: Уникальный идентификатор группы
                                    example: 1
                                  name:
                                    type: string
                                    description: Название группы
                                    example: IT Department
                                  comment:
                                    type: string
                                    description: Описание группы
                                    example: Разработка и поддержка IT систем
                                  hierarchyPathString:
                                    type: string
                                    description: Полный иерархический путь группы
                                    example: Company / IT Department / Development Team
                                  userCount:
                                    type: integer
                                    description: Количество пользователей в группе
                                    example: 25
                                  type:
                                    type: integer
                                    description: Тип группы (1=гостевая, 2=авторизованных, 9=по умолчанию)
                                    example: 2
                                  parent_id:
                                    oneOf:
                                      - type: integer
                                        minimum: 1
                                      - type: 'null'
                                    description: ID родительской группы
                                    example: null
                                  image:
                                    oneOf:
                                      - type: string
                                        format: uri
                                      - type: 'null'
                                    description: URL изображения группы
                                    example: https://s3.reezonly.com/groups/it-dept.jpg
                                  created_at:
                                    type: string
                                    format: date-time
                                    description: Дата создания
                                    example: '2023-08-25T14:15:43Z'
                                  updated_at:
                                    type: string
                                    format: date-time
                                    description: Дата обновления
                                    example: '2023-08-25T14:15:43Z'
                              - type: object
                                properties:
                                  users:
                                    type: array
                                    description: Список пользователей группы
                                    items:
                                      allOf:
                                        - type: object
                                          properties:
                                            id:
                                              type: integer
                                              example: 137
                                            email:
                                              type: string
                                              format: email
                                              example: user@example.com
                                            name:
                                              type: string
                                              example: Иван Иванов
                                            role:
                                              type: string
                                              enum:
                                                - admin
                                                - editor
                                                - curator
                                                - student
                                              x-enumDescriptions:
                                                admin: Администратор (полный доступ)
                                                editor: Контент-редактор
                                                curator: Куратор/методист
                                                student: Ученик/слушатель
                                              example: student
                                            status:
                                              type: string
                                              enum:
                                                - active
                                                - inactive
                                                - blocked
                                              x-enumDescriptions:
                                                active: Активный пользователь
                                                inactive: Неактивный (архив/черновик)
                                                blocked: Заблокирован (без доступа)
                                              example: active
                                            created_at:
                                              type: string
                                              format: date-time
                                              example: '2024-01-15T10:30:00Z'
                                            updated_at:
                                              type: string
                                              format: date-time
                                              example: '2024-01-15T10:30:00Z'
                                        - type: object
                                          properties:
                                            role_in_group:
                                              type: string
                                              description: Роль пользователя в группе
                                              example: member
                                            joined_at:
                                              type: string
                                              format: date-time
                                              description: Дата добавления в группу
                                              example: '2023-09-01T10:00:00Z'
                                  children:
                                    type: array
                                    description: Дочерние группы
                                    items:
                                      allOf:
                                        - type: object
                                          properties:
                                            id:
                                              type: integer
                                              description: Уникальный идентификатор группы
                                              example: 1
                                            name:
                                              type: string
                                              description: Название группы
                                              example: IT Department
                                            comment:
                                              type: string
                                              description: Описание группы
                                              example: Разработка и поддержка IT систем
                                            hierarchyPathString:
                                              type: string
                                              description: Полный иерархический путь группы
                                              example: Company / IT Department / Development Team
                                            userCount:
                                              type: integer
                                              description: Количество пользователей в группе
                                              example: 25
                                            type:
                                              type: integer
                                              description: Тип группы (1=гостевая, 2=авторизованных, 9=по умолчанию)
                                              example: 2
                                            parent_id:
                                              oneOf:
                                                - type: integer
                                                  minimum: 1
                                                - type: 'null'
                                              description: ID родительской группы
                                              example: null
                                            image:
                                              oneOf:
                                                - type: string
                                                  format: uri
                                                - type: 'null'
                                              description: URL изображения группы
                                              example: https://s3.reezonly.com/groups/it-dept.jpg
                                            created_at:
                                              type: string
                                              format: date-time
                                              description: Дата создания
                                              example: '2023-08-25T14:15:43Z'
                                            updated_at:
                                              type: string
                                              format: date-time
                                              description: Дата обновления
                                              example: '2023-08-25T14:15:43Z'
                                        - type: object
                                          properties:
                                            parent:
                                              oneOf:
                                                - type: object
                                                  description: Информация о родительской группе
                                                  properties:
                                                    id:
                                                      type: integer
                                                      example: 1
                                                    name:
                                                      type: string
                                                      example: IT Department
                                                - type: 'null'
                                  rules:
                                    type: array
                                    description: Правила доступа группы
                                    items:
                                      type: object
                                      properties:
                                        type:
                                          type: integer
                                          example: 1
                                        objectId:
                                          type: integer
                                          example: 42
                                        objectType:
                                          type: string
                                          example: course
              examples:
                group_detail:
                  summary: Детальная информация о группе
                  value:
                    success: true
                    data:
                      item:
                        id: 1
                        name: IT Department
                        comment: Разработка и поддержка IT систем
                        hierarchyPathString: IT Department
                        userCount: 25
                        type: 2
                        image: https://s3.reezonly.com/groups/it-dept.jpg
                        parent_id: null
                        created_at: '2023-08-25T14:15:43Z'
                        updated_at: '2023-08-25T14:15:43Z'
                        users:
                          - id: 101
                            username: john.doe
                            email: john.doe@company.com
                            role: admin
                            created_at: '2023-08-25T14:20:00Z'
                          - id: 102
                            username: jane.smith
                            email: jane.smith@company.com
                            role: editor
                            created_at: '2023-08-25T14:25:00Z'
                        children:
                          - id: 2
                            name: Development Team
                            userCount: 15
                            hierarchyPathString: IT Department / Development Team
                      rules: []
        '404':
          description: Группа не найдена
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              examples:
                group_not_found:
                  summary: Группа не найдена
                  value:
                    success: false
                    errors:
                      id:
                        - Group not found
  /group/group/create:
    post:
      tags:
        - Groups.Structure
      operationId: createGroup
      summary: Создать новую группу
      description: |
        Создает новую группу пользователей с поддержкой иерархии.
        Автоматически валидирует структуру иерархии, предотвращая циклические зависимости.
        Поддерживает загрузку изображения группы и опциональное добавление пользователей.

        **Бизнес-логика:**
        - Проверка уникальности названия в рамках родительской группы
        - Валидация иерархии (предотвращение циклов)
        - Автоматическое построение иерархического пути
        - Загрузка изображения в S3 хранилище
        - Логирование действия в ActionLog
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              allOf:
                - type: object
                  required:
                    - name
                  properties:
                    name:
                      type: string
                      minLength: 2
                      maxLength: 255
                      description: Название группы (обязательное поле)
                      example: Marketing Department
                    comment:
                      type: string
                      maxLength: 512
                      description: Описание группы (опционально)
                      example: Отдел маркетинга и продвижения
                    parent_id:
                      oneOf:
                        - type: integer
                          minimum: 1
                        - type: 'null'
                      description: |
                        ID родительской группы:
                        - `null` для корневой группы
                        - ID существующей группы для дочерней
                      example: null
                    user_ids:
                      type: array
                      items:
                        type: integer
                        minimum: 1
                      maxItems: 100
                      description: Пользователи для добавления в группу
                      example:
                        - 101
                        - 102
                    image_upload:
                      type: string
                      format: binary
                      description: Файл изображения группы (через multipart/form-data)
                - type: object
                  properties:
                    name:
                      type: string
                      description: Название группы
                      example: Support
                    comment:
                      type: string
                      description: Описание группы
                      example: Группа поддержки
                    parent_id:
                      oneOf:
                        - type: integer
                          minimum: 1
                        - type: 'null'
                      description: ID родительской группы
                    user_ids:
                      type: array
                      items:
                        type: integer
                        minimum: 1
                      description: Пользователи для добавления
                    image_upload:
                      type: string
                      format: binary
                      description: Изображение группы (multipart/form-data)
            examples:
              create_root:
                summary: Создание корневой группы
                value:
                  name: Support
              create_child:
                summary: Создание подгруппы
                value:
                  name: Support / L1
                  parent_id: 20
      responses:
        '200':
          description: Группа успешно создана
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      success:
                        type: boolean
                        example: true
                      meta:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: Общее количество элементов
                            example: 150
                          page:
                            type: integer
                            description: Текущая страница
                            example: 1
                          per-page:
                            type: integer
                            description: Элементов на странице
                            example: 20
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          group_id:
                            type: integer
                            example: 25
              examples:
                created:
                  summary: Создана подгруппа
                  value:
                    success: true
                    data:
                      group_id: 25
        '400':
          description: Ошибка валидации
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              examples:
                validation_error:
                  summary: Ошибка валидации
                  value:
                    success: false
                    errors:
                      name:
                        - Group name is required
                      parent_id:
                        - Parent group not found
        '403':
          description: Недостаточно прав
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
  /group/group/update:
    put:
      tags:
        - Groups.Structure
      operationId: updateGroup
      summary: Обновить информацию о группе
      description: |
        Обновляет базовую информацию о группе: название, описание, родительскую группу.
        При изменении parent_id автоматически перестраивается иерархический путь
        для всех дочерних групп.

        **Важно:** Изменение родительской группы затрагивает всю ветку дочерних групп.
      parameters:
        - name: id
          in: query
          required: true
          schema:
            type: integer
            minimum: 1
            example: 12
          description: ID группы для обновления
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              allOf:
                - type: object
                  required:
                    - name
                  properties:
                    name:
                      type: string
                      minLength: 2
                      maxLength: 255
                      description: Название группы (обязательное поле)
                      example: Marketing Department
                    comment:
                      type: string
                      maxLength: 512
                      description: Описание группы (опционально)
                      example: Отдел маркетинга и продвижения
                    parent_id:
                      oneOf:
                        - type: integer
                          minimum: 1
                        - type: 'null'
                      description: |
                        ID родительской группы:
                        - `null` для корневой группы
                        - ID существующей группы для дочерней
                      example: null
                    user_ids:
                      type: array
                      items:
                        type: integer
                        minimum: 1
                      maxItems: 100
                      description: Пользователи для добавления в группу
                      example:
                        - 101
                        - 102
                    image_upload:
                      type: string
                      format: binary
                      description: Файл изображения группы (через multipart/form-data)
                - type: object
                  properties:
                    name:
                      type: string
                      description: Название группы
                      example: Support
                    comment:
                      type: string
                      description: Описание группы
                      example: Группа поддержки
                    parent_id:
                      oneOf:
                        - type: integer
                          minimum: 1
                        - type: 'null'
                      description: ID родительской группы
                    user_ids:
                      type: array
                      items:
                        type: integer
                        minimum: 1
                      description: Пользователи для добавления
                    image_upload:
                      type: string
                      format: binary
                      description: Изображение группы (multipart/form-data)
            examples:
              rename:
                summary: Переименование группы
                value:
                  name: Sales / Enterprise
              move:
                summary: Перенос в другую родительскую группу
                value:
                  parent_id: 5
      responses:
        '200':
          description: Группа успешно обновлена
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      success:
                        type: boolean
                        example: true
                      meta:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: Общее количество элементов
                            example: 150
                          page:
                            type: integer
                            description: Текущая страница
                            example: 1
                          per-page:
                            type: integer
                            description: Элементов на странице
                            example: 20
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          group_id:
                            type: integer
                            example: 10
              examples:
                updated:
                  summary: Переименование и перенос
                  value:
                    success: true
                    data:
                      group_id: 10
                      name: Sales / Enterprise
                      parent_id: 5
                      comment: Ключевые клиенты
                      hierarchyPathString: Sales / Enterprise
                      userCount: 18
                      updated_at: '2025-02-11T12:00:00Z'
        '400':
          description: Ошибка валидации
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              examples:
                hierarchy_error:
                  summary: Ошибка иерархии
                  value:
                    success: false
                    errors:
                      parent_id:
                        - Cannot move group to its own child
        '404':
          description: Группа не найдена
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
  /group/group/delete:
    delete:
      tags:
        - Groups.Structure
      operationId: deleteGroup
      summary: Удалить группу
      description: |
        Удаляет группу и все связанные данные:
        - Связи пользователей с группой
        - Правила доступа группы
        - Логирование действия

        **Важно:** Нельзя удалить группу, у которой есть дочерние группы.
        Сначала нужно удалить или переместить все дочерние группы.
      parameters:
        - name: id
          in: query
          required: true
          schema:
            type: integer
            minimum: 1
          description: ID группы для удаления
      responses:
        '200':
          description: Группа успешно удалена
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  meta:
                    type: object
                    properties:
                      total:
                        type: integer
                        description: Общее количество элементов
                        example: 150
                      page:
                        type: integer
                        description: Текущая страница
                        example: 1
                      per-page:
                        type: integer
                        description: Элементов на странице
                        example: 20
              examples:
                success:
                  value:
                    success: true
        '400':
          description: Нельзя удалить группу
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              examples:
                has_children:
                  summary: Есть дочерние группы
                  value:
                    success: false
                    errors:
                      id:
                        - Cannot delete group with child groups
        '404':
          description: Группа не найдена
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
  /group/group/multiple-delete:
    delete:
      tags:
        - Groups.Structure
      operationId: deleteGroupsBulk
      summary: Массовое удаление групп
      description: |
        Удаляет несколько групп за один запрос. Каждая группа проверяется
        на отсутствие дочерних групп перед удалением.
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - groupIds
              properties:
                groupIds:
                  type: array
                  items:
                    type: integer
                    minimum: 1
                  maxItems: 50
                  description: Массив ID групп для удаления (максимум 50)
            examples:
              delete_batches:
                summary: Удаление трёх групп
                value:
                  groupIds:
                    - 10
                    - 11
                    - 12
      responses:
        '200':
          description: Результат массового удаления
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  meta:
                    type: object
                    properties:
                      total:
                        type: integer
                        description: Общее количество элементов
                        example: 150
                      page:
                        type: integer
                        description: Текущая страница
                        example: 1
                      per-page:
                        type: integer
                        description: Элементов на странице
                        example: 20
              examples:
                success:
                  summary: Удаление без ошибок
                  value:
                    success: true
  /dictionary/user/groups:
    get:
      tags:
        - Groups.Structure
      operationId: listDictionaryGroups
      summary: Получить иерархию всех групп
      description: |
        Возвращает полный список групп с иерархической структурой для выпадающих списков
        и древовидных компонентов интерфейса.
      parameters:
        - name: show_default
          in: query
          schema:
            type: boolean
            default: false
          description: Показать группы по умолчанию (гостевые, авторизованные)
      responses:
        '200':
          description: Иерархический список групп
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      success:
                        type: boolean
                        example: true
                      meta:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: Общее количество элементов
                            example: 150
                          page:
                            type: integer
                            description: Текущая страница
                            example: 1
                          per-page:
                            type: integer
                            description: Элементов на странице
                            example: 20
                  - type: object
                    properties:
                      items:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              description: ID группы
                              example: 1
                            name:
                              type: string
                              description: Название группы
                            parent_id:
                              oneOf:
                                - type: integer
                                - type: 'null'
                              description: ID родительской группы
                            level:
                              type: integer
                              description: Уровень вложенности (0=корневой)
                              example: 0
                            has_children:
                              type: boolean
                              description: Наличие дочерних групп
                              example: true
                            userCount:
                              type: integer
                              description: Количество пользователей
                              example: 15
              examples:
                full_tree:
                  summary: Полное дерево групп
                  value:
                    success: true
                    items:
                      - id: 1
                        name: Root
                        children:
                          - id: 2
                            name: Sales
                          - id: 3
                            name: Marketing
  /group/group/user-add:
    post:
      tags:
        - Groups.Members
      operationId: assignGroupUser
      summary: Добавить пользователей в группы
      description: |
        Добавляет пользователей в одну или несколько групп.
        Поддерживает пакетную обработку до 100 пользователей.
        Проверяет дубликаты и автоматически пропускает уже добавленных пользователей.
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              description: Пакетное добавление/удаление пользователей в группах через multipart/form-data
              required:
                - groupIds
                - userIds
              properties:
                groupIds:
                  type: array
                  items:
                    type: integer
                    minimum: 1
                  minItems: 1
                  maxItems: 10
                  description: ID групп для операции
                  example:
                    - 2
                    - 5
                userIds:
                  type: array
                  items:
                    type: integer
                    minimum: 1
                  minItems: 1
                  maxItems: 100
                  description: ID пользователей для добавления/удаления
                  example:
                    - 101
                    - 102
                    - 103
                role:
                  type: string
                  enum:
                    - superadmin
                    - admin
                    - editor
                    - curator
                    - student
                  description: Роль пользователя в группе (опционально, используется при добавлении)
                  example: editor
      responses:
        '200':
          description: Пользователи успешно добавлены
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  meta:
                    type: object
                    properties:
                      total:
                        type: integer
                        description: Общее количество элементов
                        example: 150
                      page:
                        type: integer
                        description: Текущая страница
                        example: 1
                      per-page:
                        type: integer
                        description: Элементов на странице
                        example: 20
        '400':
          description: Ошибка валидации
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              examples:
                limit_exceeded:
                  summary: Превышен лимит
                  value:
                    success: false
                    errors:
                      userIds:
                        - Maximum 100 users per request
  /group/group/user-delete:
    post:
      tags:
        - Groups.Members
      operationId: deleteGroupUser
      summary: Удалить пользователей из групп
      description: |
        Удаляет пользователей из указанных групп.
        Автоматически обрабатывает ситуации, когда пользователя нет в группе.
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              description: Пакетное добавление/удаление пользователей в группах через multipart/form-data
              required:
                - groupIds
                - userIds
              properties:
                groupIds:
                  type: array
                  items:
                    type: integer
                    minimum: 1
                  minItems: 1
                  maxItems: 10
                  description: ID групп для операции
                  example:
                    - 2
                    - 5
                userIds:
                  type: array
                  items:
                    type: integer
                    minimum: 1
                  minItems: 1
                  maxItems: 100
                  description: ID пользователей для добавления/удаления
                  example:
                    - 101
                    - 102
                    - 103
                role:
                  type: string
                  enum:
                    - superadmin
                    - admin
                    - editor
                    - curator
                    - student
                  description: Роль пользователя в группе (опционально, используется при добавлении)
                  example: editor
      responses:
        '200':
          description: Пользователи успешно удалены
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  meta:
                    type: object
                    properties:
                      total:
                        type: integer
                        description: Общее количество элементов
                        example: 150
                      page:
                        type: integer
                        description: Текущая страница
                        example: 1
                      per-page:
                        type: integer
                        description: Элементов на странице
                        example: 20
  /group/group/export:
    post:
      tags:
        - Groups.Structure
      operationId: createGroupExport
      summary: Запустить экспорт структуры групп
      description: |
        Создаёт задачу экспорта групп по указанным фильтрам. Возвращает идентификатор экспорта и ссылку для скачивания после формирования.

        **Назначение:** выгрузка дерева групп для сверки с внешней HR/CRM и последующего импорта/миграции.

        **Пример Use case:** HR переносит сотрудников между группами, обновляет курсы через `assign-courses`, а затем скачивает актуальный экспорт структуры, чтобы сверить дерево отделов с HRM.
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              additionalProperties: true
              description: Фильтры экспорта (аналог фильтров списка групп).
            examples:
              export_xlsx:
                summary: Экспорт в XLSX без пользователей
                value:
                  format: xlsx
                  include_users: false
              export_csv_with_users:
                summary: Экспорт в CSV с пользователями
                value:
                  format: csv
                  include_users: true
      responses:
        '200':
          description: Экспорт поставлен в очередь
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      success:
                        type: boolean
                        example: true
                      meta:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: Общее количество элементов
                            example: 150
                          page:
                            type: integer
                            description: Текущая страница
                            example: 1
                          per-page:
                            type: integer
                            description: Элементов на странице
                            example: 20
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          export_id:
                            type: integer
                            example: 102
                          download_url:
                            type: string
                            format: uri
                            example: https://space.example.com/export/102.xlsx
              examples:
                started:
                  summary: Задача экспорта создана
                  value:
                    success: true
                    data:
                      export_id: 102
                      download_url: https://space.example.com/export/102.xlsx
        '500':
          description: Внутренняя ошибка сервера
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  server:
                    - Internal server error. Try again later
  /group/group/export-download:
    get:
      tags:
        - Groups.Structure
      operationId: createGroupExportDownload
      summary: Скачать сформированный экспорт групп
      parameters:
        - name: id
          in: query
          required: true
          schema:
            type: integer
            minimum: 1
          description: ID задания экспорта
      responses:
        '200':
          description: Экспорт готов
          content:
            application/octet-stream:
              schema:
                type: string
                format: binary
              examples:
                export_file:
                  summary: Готовый XLSX экспорт
                  value: UEsDBBQACAgI...
        '404':
          description: Ресурс не найден
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  id:
                    - Ресурс не найден
  /group/group/assign-courses:
    post:
      tags:
        - Groups.Members
      operationId: assignGroupCourses
      summary: Назначить курсы всем участникам группы
      description: |
        Назначает указанные курсы всем текущим участникам группы.
        Операция выполняется асинхронно через очередь для больших групп.
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              description: Назначение курсов всем пользователям группы (multipart/form-data)
              required:
                - group_id
                - course_ids
              properties:
                group_id:
                  type: integer
                  minimum: 1
                  description: ID группы, для которой назначаются курсы
                  example: 12
                course_ids:
                  type: array
                  items:
                    type: integer
                    minimum: 1
                  minItems: 1
                  maxItems: 50
                  description: Идентификаторы курсов для назначения
                  example:
                    - 501
                    - 502
                    - 503
      responses:
        '200':
          description: Курсы успешно назначены
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  meta:
                    type: object
                    properties:
                      total:
                        type: integer
                        description: Общее количество элементов
                        example: 150
                      page:
                        type: integer
                        description: Текущая страница
                        example: 1
                      per-page:
                        type: integer
                        description: Элементов на странице
                        example: 20
              examples:
                queued:
                  summary: Задача поставлена в очередь
                  value:
                    success: true
  /certificate/template/index:
    get:
      operationId: listCertificateTemplates
      tags:
        - Certificates.Templates
      summary: Получить список шаблонов сертификатов
      description: Возвращает все доступные шаблоны для генерации сертификатов
      parameters:
        - in: query
          name: page
          description: Номер страницы для пагинации
          required: false
          schema:
            type: integer
            minimum: 1
            default: 1
            example: 1
        - in: query
          name: per-page
          description: Количество элементов на странице (максимум 100)
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
            example: 50
        - name: active_only
          in: query
          required: false
          schema:
            type: boolean
            default: true
          description: Показать только активные шаблоны
      responses:
        '200':
          description: List of certificate templates
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      success:
                        type: boolean
                        example: true
                      meta:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: Общее количество элементов
                            example: 150
                          page:
                            type: integer
                            description: Текущая страница
                            example: 1
                          per-page:
                            type: integer
                            description: Элементов на странице
                            example: 20
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          pagination:
                            type: object
                            properties:
                              total:
                                type: integer
                                description: Общее количество элементов
                                example: 150
                              page:
                                type: integer
                                description: Текущая страница
                                example: 1
                              per-page:
                                type: integer
                                description: Элементов на странице
                                example: 20
                          items:
                            type: array
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  example: 3
                                name:
                                  type: string
                                  description: Название шаблона сертификата
                                  example: Standard Completion
                                description:
                                  type: string
                                  description: Краткое описание шаблона
                                  example: Базовый шаблон для завершения курса
                                file_url:
                                  type: string
                                  format: uri
                                  description: Ссылка на файл шаблона (PDF/DOCX)
                                  example: https://cdn.space.com/cert-templates/standard.pdf
                                preview_url:
                                  type: string
                                  format: uri
                                  description: Превью изображения шаблона
                                  example: https://cdn.space.com/cert-templates/standard.png
                                created_at:
                                  type: string
                                  format: date-time
                                  example: '2024-12-01T10:00:00Z'
                                updated_at:
                                  type: string
                                  format: date-time
                                  example: '2024-12-15T15:30:00Z'
              examples:
                templates_page:
                  summary: Список активных шаблонов
                  value:
                    success: true
                    data:
                      pagination:
                        total: 2
                        page: 1
                        per_page: 20
                      items:
                        - id: 1
                          name: Default Blue
                          description: Базовый синий шаблон
                          preview_url: https://cdn.space/templates/1/preview.png
                          active: true
                          created_at: '2024-10-01T12:00:00Z'
                          updated_at: '2024-11-01T08:00:00Z'
                        - id: 2
                          name: Gold Award
                          description: Золотой шаблон для VIP выпусков
                          preview_url: https://cdn.space/templates/2/preview.png
                          active: true
                          created_at: '2024-10-05T09:00:00Z'
                          updated_at: '2024-11-02T10:00:00Z'
  /certificate/template/view:
    get:
      operationId: getCertificateTemplate
      tags:
        - Certificates.Templates
      summary: Получить детальную информацию о шаблоне сертификата
      description: Возвращает полную информацию о шаблоне включая переменные и предпросмотр
      parameters:
        - in: query
          name: id
          description: Идентификатор ресурса
          required: true
          schema:
            type: integer
            minimum: 1
            example: 42
      responses:
        '200':
          description: Certificate template details
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      success:
                        type: boolean
                        example: true
                      meta:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: Общее количество элементов
                            example: 150
                          page:
                            type: integer
                            description: Текущая страница
                            example: 1
                          per-page:
                            type: integer
                            description: Элементов на странице
                            example: 20
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id:
                            type: integer
                          name:
                            type: string
                          description:
                            type: string
                          template_html:
                            type: string
                          variables:
                            type: array
                            items:
                              type: object
                              properties:
                                name:
                                  type: string
                                type:
                                  type: string
                                description:
                                  type: string
                                required:
                                  type: boolean
                          preview_url:
                            type: string
                          active:
                            type: boolean
              examples:
                template_detail:
                  summary: Детальный шаблон
                  value:
                    success: true
                    data:
                      id: 2
                      name: Gold Award
                      description: Золотой шаблон для VIP выпусков
                      template_html: <html>...шаблон...</html>
                      variables:
                        - name: username
                          type: string
                          description: Имя студента
                          required: true
                        - name: course_title
                          type: string
                          required: true
                      preview_url: https://cdn.space/templates/2/preview.png
                      active: true
        '404':
          description: Template not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  id:
                    - Ресурс не найден
  /certificate/certificate/index:
    get:
      operationId: listCertificates
      tags:
        - Certificates.Issued
      summary: Получить список выданных сертификатов
      description: Возвращает список выданных сертификатов с фильтрацией
      parameters:
        - in: query
          name: page
          description: Номер страницы для пагинации
          required: false
          schema:
            type: integer
            minimum: 1
            default: 1
            example: 1
        - in: query
          name: per-page
          description: Количество элементов на странице (максимум 100)
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
            example: 50
        - name: user_id
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
          description: Фильтр по ID пользователя
        - name: course_id
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
          description: Фильтр по ID курса
        - name: status
          in: query
          required: false
          schema:
            type: string
            enum:
              - issued
              - revoked
              - expired
          description: Фильтр по статусу сертификата
        - name: date_from
          in: query
          required: false
          schema:
            type: string
            format: date
          description: Дата выдачи от
        - name: date_to
          in: query
          required: false
          schema:
            type: string
            format: date
          description: Дата выдачи до
      responses:
        '200':
          description: List of issued certificates
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      success:
                        type: boolean
                        example: true
                      meta:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: Общее количество элементов
                            example: 150
                          page:
                            type: integer
                            description: Текущая страница
                            example: 1
                          per-page:
                            type: integer
                            description: Элементов на странице
                            example: 20
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          pagination:
                            type: object
                            properties:
                              total:
                                type: integer
                                description: Общее количество элементов
                                example: 150
                              page:
                                type: integer
                                description: Текущая страница
                                example: 1
                              per-page:
                                type: integer
                                description: Элементов на странице
                                example: 20
                          items:
                            type: array
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  example: 1
                                title:
                                  type: string
                                  example: Сертификат о прохождении курса
                                description:
                                  type: string
                                  example: Выдан за успешное завершение курса
                                issued_at:
                                  type: string
                                  format: date-time
                                  example: '2024-01-15T10:30:00Z'
                                status:
                                  type: string
                                  enum:
                                    - issued
                                    - revoked
                                    - expired
                                  x-enumDescriptions:
                                    issued: Сертификат выдан
                                    revoked: Сертификат отозван
                                    expired: Срок действия истёк
                                  example: issued
              examples:
                list:
                  summary: Список сертификатов с фильтрами
                  value:
                    success: true
                    data:
                      pagination:
                        total: 2
                        page: 1
                        per_page: 20
                      items:
                        - id: 9001
                          number: CERT-2025-0001
                          user_id: 123
                          course_id: 456
                          template_id: 2
                          status: issued
                          issued_at: '2025-02-11T09:00:00Z'
                        - id: 9002
                          number: CERT-2025-0002
                          user_id: 140
                          course_id: 480
                          template_id: 3
                          status: issued
                          issued_at: '2025-02-12T11:00:00Z'
  /certificate/certificate/view:
    get:
      operationId: getCertificate
      tags:
        - Certificates.Issued
      summary: Получить информацию о выданном сертификате
      description: Возвращает детальную информацию о конкретном выданном сертификате
      parameters:
        - in: query
          name: id
          description: Идентификатор ресурса
          required: true
          schema:
            type: integer
            minimum: 1
            example: 42
      responses:
        '200':
          description: Certificate details
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      success:
                        type: boolean
                        example: true
                      meta:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: Общее количество элементов
                            example: 150
                          page:
                            type: integer
                            description: Текущая страница
                            example: 1
                          per-page:
                            type: integer
                            description: Элементов на странице
                            example: 20
                  - type: object
                    properties:
                      data:
                        allOf:
                          - type: object
                            properties:
                              id:
                                type: integer
                                example: 1
                              title:
                                type: string
                                example: Сертификат о прохождении курса
                              description:
                                type: string
                                example: Выдан за успешное завершение курса
                              issued_at:
                                type: string
                                format: date-time
                                example: '2024-01-15T10:30:00Z'
                              status:
                                type: string
                                enum:
                                  - issued
                                  - revoked
                                  - expired
                                x-enumDescriptions:
                                  issued: Сертификат выдан
                                  revoked: Сертификат отозван
                                  expired: Срок действия истёк
                                example: issued
                          - type: object
                            properties:
                              user:
                                type: object
                                properties:
                                  id:
                                    type: integer
                                    example: 137
                                  email:
                                    type: string
                                    format: email
                                    example: user@example.com
                                  name:
                                    type: string
                                    example: Иван Иванов
                                  role:
                                    type: string
                                    enum:
                                      - admin
                                      - editor
                                      - curator
                                      - student
                                    x-enumDescriptions:
                                      admin: Администратор (полный доступ)
                                      editor: Контент-редактор
                                      curator: Куратор/методист
                                      student: Ученик/слушатель
                                    example: student
                                  status:
                                    type: string
                                    enum:
                                      - active
                                      - inactive
                                      - blocked
                                    x-enumDescriptions:
                                      active: Активный пользователь
                                      inactive: Неактивный (архив/черновик)
                                      blocked: Заблокирован (без доступа)
                                    example: active
                                  created_at:
                                    type: string
                                    format: date-time
                                    example: '2024-01-15T10:30:00Z'
                                  updated_at:
                                    type: string
                                    format: date-time
                                    example: '2024-01-15T10:30:00Z'
                              course:
                                type: object
                                properties:
                                  id:
                                    type: integer
                                    example: 480
                                  title:
                                    type: string
                                    example: Data Analytics 101
                              template:
                                type: object
                                properties:
                                  id:
                                    type: integer
                                    example: 3
                                  name:
                                    type: string
                                    description: Название шаблона сертификата
                                    example: Standard Completion
                                  description:
                                    type: string
                                    description: Краткое описание шаблона
                                    example: Базовый шаблон для завершения курса
                                  file_url:
                                    type: string
                                    format: uri
                                    description: Ссылка на файл шаблона (PDF/DOCX)
                                    example: https://cdn.space.com/cert-templates/standard.pdf
                                  preview_url:
                                    type: string
                                    format: uri
                                    description: Превью изображения шаблона
                                    example: https://cdn.space.com/cert-templates/standard.png
                                  created_at:
                                    type: string
                                    format: date-time
                                    example: '2024-12-01T10:00:00Z'
                                  updated_at:
                                    type: string
                                    format: date-time
                                    example: '2024-12-15T15:30:00Z'
                              download_url:
                                type: string
                                format: uri
                                description: Ссылка на скачивание PDF сертификата
                                example: https://cdn.space.com/certificates/CERT-2025-0001.pdf
              examples:
                detail:
                  summary: Детальный сертификат
                  value:
                    success: true
                    data:
                      id: 9001
                      number: CERT-2025-0001
                      user:
                        id: 123
                        username: Иван Иванов
                        email: ivan@example.com
                      course:
                        id: 456
                        name: Онбординг
                      template_id: 2
                      status: issued
                      pdf_url: https://cdn.space/certificates/9001.pdf
                      verification_url: https://verify.space/CERT-2025-0001
                      issued_at: '2025-02-11T09:00:00Z'
                      expires_at: '2026-02-11T09:00:00Z'
        '404':
          description: Certificate not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  id:
                    - Ресурс не найден
  /certificate/certificate/create:
    post:
      operationId: createCertificate
      tags:
        - Certificates.Issued
      summary: Выдать сертификат
      description: Выдает новый сертификат пользователю за прохождение курса
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - user_id
                - course_id
                - template_id
              properties:
                user_id:
                  type: integer
                  minimum: 1
                  description: ID пользователя
                course_id:
                  type: integer
                  minimum: 1
                  description: ID курса
                template_id:
                  type: integer
                  minimum: 1
                  description: ID шаблона сертификата
                issue_date:
                  type: string
                  format: date
                  description: Дата выдачи (по умолчанию текущая)
                expires_at:
                  type: string
                  format: date
                  description: Дата истечения (необязательно)
                custom_data:
                  type: object
                  description: Дополнительные данные для шаблона
            examples:
              issue_single:
                summary: Выдача сертификата студенту
                value:
                  user_id: 123
                  course_id: 456
                  template_id: 2
                  issue_date: '2024-01-15'
                  expires_at: '2025-01-15'
                  custom_data:
                    username: Иван Иванов
                    course_title: Онбординг
      responses:
        '200':
          description: Certificate issued
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  meta:
                    type: object
                    properties:
                      total:
                        type: integer
                        description: Общее количество элементов
                        example: 150
                      page:
                        type: integer
                        description: Текущая страница
                        example: 1
                      per-page:
                        type: integer
                        description: Элементов на странице
                        example: 20
              examples:
                issued:
                  summary: Сертификат выдан
                  value:
                    success: true
                    message: Certificate created
        '400':
          description: Validation error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  password:
                    - Password must be at least 6 characters
  /certificate/certificate/download:
    get:
      operationId: downloadCertificate
      tags:
        - Certificates.Issued
      summary: Скачать PDF сертификата
      description: Возвращает PDF файл сертификата для скачивания
      parameters:
        - in: query
          name: id
          description: Идентификатор ресурса
          required: true
          schema:
            type: integer
            minimum: 1
            example: 42
      responses:
        '200':
          description: PDF certificate file
          content:
            application/pdf:
              schema:
                type: string
                format: binary
              examples:
                pdf_file:
                  summary: PDF сертификата
                  value: UEsDBBQACAgI...
        '404':
          description: Certificate not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  id:
                    - Ресурс не найден
  /certificate/download-zip:
    post:
      operationId: downloadCertificatesZip
      tags:
        - Certificates.Issued
      summary: Сформировать ZIP с сертификатами
      description: |
        Запускает генерацию ZIP-архива сертификатов по фильтрам (search, course_id, user_id, пагинация, сортировка). Одновременно может быть только одна активная задача на ключ.

        **Назначение:** массовая выгрузка сертификатов для передачи внешним системам или печати.

        **Пример Use case:** администратор выбирает курс и диапазон пользователей, запускает экспорт и получает ссылку на архив.
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                search:
                  type: string
                course_id:
                  type: integer
                  minimum: 1
                user_id:
                  type: integer
                  minimum: 1
                page:
                  type: integer
                  minimum: 1
                  default: 1
                per-page:
                  type: integer
                  minimum: 1
                  maximum: 500
                  default: 50
                sort:
                  type: string
                  example: '-created_at'
            examples:
              download_zip_request:
                summary: Экспорт сертификатов по курсу
                value:
                  course_id: 456
                  page: 1
                  per-page: 100
                  sort: '-issued_at'
      responses:
        '200':
          description: Задача запущена
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      success:
                        type: boolean
                        example: true
                      meta:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: Общее количество элементов
                            example: 150
                          page:
                            type: integer
                            description: Текущая страница
                            example: 1
                          per-page:
                            type: integer
                            description: Элементов на странице
                            example: 20
                  - type: object
                    properties:
                      message:
                        type: string
                        example: Commit job queued
                      data:
                        type: object
                        properties:
                          filePath:
                            type: string
                            format: uri
                            example: /uploads/certificates/zip/abc.zip
              examples:
                download_zip_queued:
                  summary: Задача на экспорт создана
                  value:
                    success: true
                    message: Commit job queued
                    data:
                      filePath: /uploads/certificates/zip/certificates-2025-02-11.zip
        '400':
          description: Ошибка в запросе (неверные параметры)
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  email:
                    - Некорректный email
                  page:
                    - page must be >= 1
  /certificate/course/index:
    get:
      operationId: listCertificateCourses
      tags:
        - Certificates.Lookups
      summary: Список курсов для выдачи сертификатов
      description: Возвращает курсы (id, title, type) для выбора `course_id` при выдаче сертификатов.
      parameters:
        - in: query
          name: page
          description: Номер страницы для пагинации
          required: false
          schema:
            type: integer
            minimum: 1
            default: 1
            example: 1
        - in: query
          name: per-page
          description: Количество элементов на странице (максимум 100)
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
            example: 50
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      success:
                        type: boolean
                        example: true
                      meta:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: Общее количество элементов
                            example: 150
                          page:
                            type: integer
                            description: Текущая страница
                            example: 1
                          per-page:
                            type: integer
                            description: Элементов на странице
                            example: 20
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          pagination:
                            type: object
                            properties:
                              total:
                                type: integer
                                description: Общее количество элементов
                                example: 150
                              page:
                                type: integer
                                description: Текущая страница
                                example: 1
                              per-page:
                                type: integer
                                description: Элементов на странице
                                example: 20
                          items:
                            type: array
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  example: 12
                                title:
                                  type: string
                                  example: Онбординг
                                type:
                                  type: string
                                  example: course
              examples:
                courses_page:
                  summary: Курсы для выбора сертификата
                  value:
                    success: true
                    data:
                      pagination:
                        total: 2
                        page: 1
                        per_page: 20
                      items:
                        - id: 12
                          title: Онбординг
                          type: course
                        - id: 18
                          title: Менторская программа
                          type: program
  /certificate/user/index:
    get:
      operationId: listCertificateUsers
      tags:
        - Certificates.Lookups
      summary: Список пользователей для выдачи сертификатов
      description: Возвращает пользователей (id, username, email) для выбора `user_id` при выдаче сертификатов.
      parameters:
        - in: query
          name: page
          description: Номер страницы для пагинации
          required: false
          schema:
            type: integer
            minimum: 1
            default: 1
            example: 1
        - in: query
          name: per-page
          description: Количество элементов на странице (максимум 100)
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
            example: 50
        - name: search
          in: query
          schema:
            type: string
          description: Поиск по имени/email
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      success:
                        type: boolean
                        example: true
                      meta:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: Общее количество элементов
                            example: 150
                          page:
                            type: integer
                            description: Текущая страница
                            example: 1
                          per-page:
                            type: integer
                            description: Элементов на странице
                            example: 20
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          pagination:
                            type: object
                            properties:
                              total:
                                type: integer
                                description: Общее количество элементов
                                example: 150
                              page:
                                type: integer
                                description: Текущая страница
                                example: 1
                              per-page:
                                type: integer
                                description: Элементов на странице
                                example: 20
                          items:
                            type: array
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  example: 101
                                username:
                                  type: string
                                  example: Иван Иванов
                                email:
                                  type: string
                                  example: ivan@example.com
              examples:
                users_page:
                  summary: Пользователи для выдачи
                  value:
                    success: true
                    data:
                      pagination:
                        total: 2
                        page: 1
                        per_page: 20
                      items:
                        - id: 101
                          username: Иван Иванов
                          email: ivan@example.com
                        - id: 102
                          username: Мария Петрова
                          email: maria@example.com
  /certificate/type/index:
    get:
      operationId: listCertificateTypes
      tags:
        - Certificates.Lookups
      summary: Справочник типов сертификатов
      description: Возвращает список типов сертификатов для подстановки в запросах выдачи.
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      success:
                        type: boolean
                        example: true
                      meta:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: Общее количество элементов
                            example: 150
                          page:
                            type: integer
                            description: Текущая страница
                            example: 1
                          per-page:
                            type: integer
                            description: Элементов на странице
                            example: 20
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          pagination:
                            type: object
                            properties:
                              total:
                                type: integer
                                description: Общее количество элементов
                                example: 150
                              page:
                                type: integer
                                description: Текущая страница
                                example: 1
                              per-page:
                                type: integer
                                description: Элементов на странице
                                example: 20
                          items:
                            type: array
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  example: 1
                                name:
                                  type: string
                                  example: Course completion
                                description:
                                  type: string
                                  nullable: true
                                  example: Выдаётся за прохождение курса
              examples:
                certificate_types:
                  summary: Доступные типы сертификатов
                  value:
                    success: true
                    data:
                      pagination:
                        total: 2
                        page: 1
                        per_page: 20
                      items:
                        - id: 1
                          name: Course completion
                          description: Выдаётся за прохождение курса
                        - id: 2
                          name: Exam
                          description: Выдаётся за сдачу экзамена
  /certificate/variable/index:
    get:
      operationId: listCertificateVariables
      tags:
        - Certificates.Lookups
      summary: Список переменных сертификатов
      description: Возвращает доступные переменные для шаблонов сертификатов (ключ, имя, обязательность).
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      success:
                        type: boolean
                        example: true
                      meta:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: Общее количество элементов
                            example: 150
                          page:
                            type: integer
                            description: Текущая страница
                            example: 1
                          per-page:
                            type: integer
                            description: Элементов на странице
                            example: 20
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          pagination:
                            type: object
                            properties:
                              total:
                                type: integer
                                description: Общее количество элементов
                                example: 150
                              page:
                                type: integer
                                description: Текущая страница
                                example: 1
                              per-page:
                                type: integer
                                description: Элементов на странице
                                example: 20
                          items:
                            type: array
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  example: 5
                                key:
                                  type: string
                                  example: username
                                name:
                                  type: string
                                  example: Имя пользователя
                                description:
                                  type: string
                                  nullable: true
                                  example: Отображается на сертификате
                                required:
                                  type: boolean
                                  example: true
              examples:
                certificate_variables:
                  summary: Переменные для шаблонов
                  value:
                    success: true
                    data:
                      pagination:
                        total: 2
                        page: 1
                        per_page: 20
                      items:
                        - id: 5
                          key: username
                          name: Имя пользователя
                          description: Отображается на сертификате
                          required: true
                        - id: 6
                          key: course_title
                          name: Название курса
                          required: true
  /certificate/variable-list/index:
    get:
      operationId: listCertificateVariableValues
      tags:
        - Certificates.Lookups
      summary: Наборы переменных сертификатов
      description: Возвращает значения переменных (variable_id, key, value) для подстановки в шаблоны.
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      success:
                        type: boolean
                        example: true
                      meta:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: Общее количество элементов
                            example: 150
                          page:
                            type: integer
                            description: Текущая страница
                            example: 1
                          per-page:
                            type: integer
                            description: Элементов на странице
                            example: 20
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          pagination:
                            type: object
                            properties:
                              total:
                                type: integer
                                description: Общее количество элементов
                                example: 150
                              page:
                                type: integer
                                description: Текущая страница
                                example: 1
                              per-page:
                                type: integer
                                description: Элементов на странице
                                example: 20
                          items:
                            type: array
                            items:
                              type: object
                              properties:
                                variable_id:
                                  type: integer
                                  example: 5
                                key:
                                  type: string
                                  example: username
                                value:
                                  type: string
                                  example: Иван Иванов
              examples:
                certificate_variable_values:
                  summary: Значения переменных
                  value:
                    success: true
                    data:
                      pagination:
                        total: 2
                        page: 1
                        per_page: 20
                      items:
                        - variable_id: 5
                          key: username
                          value: Иван Иванов
                        - variable_id: 6
                          key: course_title
                          value: Онбординг
  /course/course/index:
    get:
      operationId: listCourses
      tags:
        - Courses
      summary: Получить каталог курсов
      description: Возвращает список доступных курсов с базовой информацией (только чтение)
      parameters:
        - in: query
          name: page
          description: Номер страницы для пагинации
          required: false
          schema:
            type: integer
            minimum: 1
            default: 1
            example: 1
        - in: query
          name: per-page
          description: Количество элементов на странице (максимум 100)
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
            example: 50
        - name: category_id
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
          description: Фильтр по ID категории курсов
        - name: status
          in: query
          required: false
          schema:
            type: string
            enum:
              - active
              - inactive
              - archived
            default: active
          description: Фильтр по статусу курса
        - name: featured
          in: query
          required: false
          schema:
            type: boolean
            default: false
          description: Показать только рекомендуемые курсы
      responses:
        '200':
          description: List of courses
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      success:
                        type: boolean
                        example: true
                      meta:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: Общее количество элементов
                            example: 150
                          page:
                            type: integer
                            description: Текущая страница
                            example: 1
                          per-page:
                            type: integer
                            description: Элементов на странице
                            example: 20
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              example: 101
                            title:
                              type: string
                              example: Онбординг
                            description:
                              type: string
                              example: Базовый курс для новых сотрудников
                            status:
                              type: string
                              example: active
                            price:
                              type: number
                              example: 1990
                            duration:
                              type: string
                              example: 6h
                            category:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  example: 5
                                name:
                                  type: string
                                  example: Корпоративное обучение
                            thumbnail_url:
                              type: string
                              example: https://cdn.space/courses/101.png
                            lms_id:
                              type: integer
                              description: ID курса в LMS системе
                              example: 501
                            student_count:
                              type: integer
                              example: 240
              examples:
                courses_page:
                  summary: Список курсов с фильтром по статусу
                  value:
                    success: true
                    data:
                      - id: 101
                        title: Онбординг
                        description: Базовый курс для новых сотрудников
                        status: active
                        price: 0
                        duration: 2h
                        category:
                          id: 5
                          name: Корпоративное обучение
                        thumbnail_url: https://cdn.space/courses/101.png
                        lms_id: 501
                        student_count: 240
                      - id: 102
                        title: Продажи B2B
                        description: Практикум по продажам
                        status: active
                        price: 1990
                        duration: 6h
                        category:
                          id: 6
                          name: Продажи
                        thumbnail_url: https://cdn.space/courses/102.png
                        lms_id: 502
                        student_count: 120
  /course/course/view:
    get:
      operationId: getCourse
      tags:
        - Courses
      summary: Получить детальную информацию о курсе
      description: Возвращает полную информацию о курсе включая программу обучения (только чтение)
      parameters:
        - in: query
          name: id
          description: Идентификатор ресурса
          required: true
          schema:
            type: integer
            minimum: 1
            example: 42
      responses:
        '200':
          description: Course details
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      success:
                        type: boolean
                        example: true
                      meta:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: Общее количество элементов
                            example: 150
                          page:
                            type: integer
                            description: Текущая страница
                            example: 1
                          per-page:
                            type: integer
                            description: Элементов на странице
                            example: 20
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          item:
                            allOf:
                              - type: object
                                properties:
                                  id:
                                    type: integer
                                    example: 101
                                  title:
                                    type: string
                                    example: Онбординг
                                  description:
                                    type: string
                                    example: Базовый курс для новых сотрудников
                                  status:
                                    type: string
                                    enum:
                                      - draft
                                      - active
                                      - archived
                                    example: active
                                  price:
                                    type: number
                                    format: float
                                    example: 0
                                  duration:
                                    type: string
                                    description: Продолжительность в удобном формате
                                    example: 2h
                                  level:
                                    type: string
                                    enum:
                                      - beginner
                                      - intermediate
                                      - advanced
                                    example: beginner
                                  category:
                                    type: object
                                    properties:
                                      id:
                                        type: integer
                                        example: 5
                                      name:
                                        type: string
                                        example: Корпоративное обучение
                                  instructor:
                                    type: object
                                    properties:
                                      id:
                                        type: integer
                                        example: 77
                                      name:
                                        type: string
                                        example: Анна Смирнова
                                      avatar_url:
                                        type: string
                                        format: uri
                                        example: https://cdn.space/instructors/77.png
                                  thumbnail_url:
                                    type: string
                                    format: uri
                                    example: https://cdn.space/courses/101.png
                                  lms_id:
                                    type: integer
                                    example: 501
                              - type: object
                                properties:
                                  syllabus:
                                    type: array
                                    description: Список модулей/уроков
                                    items:
                                      type: object
                                      properties:
                                        id:
                                          type: integer
                                          example: 1
                                        title:
                                          type: string
                                          example: Введение
                                        description:
                                          type: string
                                          example: Как работать в системе
                                        duration:
                                          type: string
                                          example: 10m
              examples:
                course_detail:
                  summary: Детальный курс с программой
                  value:
                    success: true
                    data:
                      item:
                        id: 101
                        title: Онбординг
                        description: Базовый курс для новых сотрудников
                        status: active
                        price: 0
                        duration: 2h
                        level: beginner
                        category:
                          id: 5
                          name: Корпоративное обучение
                        instructor:
                          id: 77
                          name: Анна Смирнова
                          avatar_url: https://cdn.space/instructors/77.png
                        thumbnail_url: https://cdn.space/courses/101.png
                        lms_id: 501
                        syllabus:
                          - id: 1
                            title: Введение
                            description: Как работать в системе
                            duration: 10m
                            order: 1
                        requirements:
                          - Корпоративная почта
                        outcomes:
                          - Понимание процессов компании
                        student_count: 240
                        rating: 4.8
                        reviews_count: 56
                        created_at: '2024-01-10T09:00:00Z'
                        updated_at: '2024-11-02T11:00:00Z'
        '404':
          description: Course not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  id:
                    - Ресурс не найден
  /dictionary/dictionary/page-types:
    get:
      operationId: listPageTypes
      tags:
        - Pages
      summary: Получить список типов страниц
      description: |
        Справочник типов страниц сайта и продуктов (read-only): landing, blog, help, legal и другие.

        **Назначение:** дать фронтам и внешним CMS нормализованные типы для фильтров и группировки страниц/лендингов.

        **Ключевые особенности:** стабильные коды типов, совместимость с `/dictionary/dictionary/pages`, можно кешировать на клиенте.

        **Пример Use case:** SPA-витрина запрашивает типы, строит фильтры и подсветку меню по категориям страниц.
      responses:
        '200':
          description: Page types list
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      success:
                        type: boolean
                        example: true
                      meta:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: Общее количество элементов
                            example: 150
                          page:
                            type: integer
                            description: Текущая страница
                            example: 1
                          per-page:
                            type: integer
                            description: Элементов на странице
                            example: 20
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          items:
                            type: array
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  example: 3
                                name:
                                  type: string
                                  example: product-page
                            example:
                              id: 3
                              name: landing
              examples:
                page_types:
                  summary: Доступные типы страниц
                  value:
                    success: true
                    data:
                      items:
                        - id: 3
                          name: landing
                        - id: 4
                          name: blog
        '400':
          description: Ошибка в запросе (неверные параметры)
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  email:
                    - Некорректный email
                  page:
                    - page must be >= 1
  /dictionary/dictionary/pages:
    get:
      operationId: listPages
      tags:
        - Pages
      summary: Получить справочник страниц
      description: |
        Доступные страницы сайта (лендинги, продуктовые страницы) с базовыми метаданными (read-only): `title`, `alias`, `type`, `enabled`, SEO-атрибуты.

        **Назначение:** раскрыть структуру публичных и закрытых страниц, чтобы внешние CMS могли собирать меню и лендинги без доступа в админку.

        **Ключевые особенности:** фильтрация по типу (используйте `/dictionary/dictionary/page-types`), статус `enabled`, поля `alias` и `category` для навигации.

        **Пример Use case:** внешняя система заимствует SPA-меню, вызывает `/dictionary/dictionary/pages`, сортирует по типу и обновляет ссылки на новом сайте без внутреннего CMS.
      responses:
        '200':
          description: Pages list
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      success:
                        type: boolean
                        example: true
                      meta:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: Общее количество элементов
                            example: 150
                          page:
                            type: integer
                            description: Текущая страница
                            example: 1
                          per-page:
                            type: integer
                            description: Элементов на странице
                            example: 20
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          items:
                            type: array
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  example: 12
                                alias:
                                  type: string
                                  example: product-page-42
                                title:
                                  type: string
                                  example: Курс "Data Science"
                                description:
                                  type: string
                                  example: Лендинг продукта Data Science
                                enabled:
                                  type: boolean
                                  example: true
                                type:
                                  type: string
                                  description: Тип страницы (используйте справочник page-types)
                                  example: course-and-training-promo-page
                            example:
                              id: 12
                              alias: product-page-42
                              title: Курс "Data Science"
                              description: Лендинг продукта Data Science
                              enabled: true
                              type: product-page
              examples:
                pages_dict:
                  summary: Справочник страниц
                  value:
                    success: true
                    data:
                      items:
                        - id: 12
                          alias: product-page-42
                          title: Курс "Data Science"
                          description: Лендинг продукта Data Science
                          enabled: true
                          type: product-page
                        - id: 18
                          alias: help-center
                          title: Центр помощи
                          description: Справочные статьи
                          enabled: true
                          type: help
        '400':
          description: Ошибка в запросе (неверные параметры)
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  email:
                    - Некорректный email
                  page:
                    - page must be >= 1
  /integration/report/consolidated:
    post:
      operationId: createIntegrationReport
      tags:
        - Integration Reports
      summary: Сводный отчёт (JSON)
      description: |
        JSON-эквивалент XLSX «Сводный» отчёта с фильтрами по продуктам, группам, прогрессу и полям профиля.

        **Назначение:** отдать тот же набор колонок, что в XLSX «Сводный», но в JSON для BI/дашбордов без генерации файлов.

        **Пример Use case:** BI-интеграция запрашивает данные по конкретным продуктам и отделам, строит графики прогресса и статусов оплат без скачивания XLSX.
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                product:
                  type: array
                  items:
                    type: integer
                  example:
                    - 59
                    - 62
                group:
                  type: array
                  items:
                    type: integer
                  example:
                    - 14
                user_ids:
                  type: array
                  items:
                    type: integer
                  example:
                    - 215
                    - 216
                progress_from:
                  type: integer
                  minimum: 0
                  maximum: 100
                  default: 0
                  example: 50
                progress_to:
                  type: integer
                  minimum: 0
                  maximum: 100
                  default: 100
                  example: 85
                fields:
                  type: object
                  additionalProperties:
                    type: array
                    items:
                      type: string
                  description: Фильтры по полям профиля (username, email, phone, department, position)
                  example:
                    email:
                      - '@example.com'
                page:
                  type: integer
                  minimum: 1
                  default: 1
                  example: 1
                per-page:
                  type: integer
                  minimum: 1
                  maximum: 1000
                  default: 200
                  example: 200
                sort:
                  type: string
                  enum:
                    - '-date_added'
                    - date_added
                    - '-progress'
                    - progress
                  default: '-date_added'
                  example: '-date_added'
            examples:
              consolidated_request:
                summary: Фильтр по продуктам и прогрессу
                value:
                  product:
                    - 59
                    - 62
                  group:
                    - 14
                  progress_from: 50
                  progress_to: 85
                  page: 1
                  per-page: 200
                  sort: '-date_added'
      responses:
        '200':
          description: Отчёт сформирован
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      success:
                        type: boolean
                        example: true
                      meta:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: Общее количество элементов
                            example: 150
                          page:
                            type: integer
                            description: Текущая страница
                            example: 1
                          per-page:
                            type: integer
                            description: Элементов на странице
                            example: 20
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          filters:
                            type: object
                          items:
                            type: array
                            items:
                              type: object
                              properties:
                                product:
                                  type: object
                                  properties:
                                    id:
                                      type: integer
                                      example: 59
                                    title:
                                      type: string
                                      example: Цифровые коммуникации
                                status:
                                  type: object
                                  properties:
                                    code:
                                      type: integer
                                      example: 4
                                    name:
                                      type: string
                                      example: Оплачен
                                amount:
                                  type: number
                                  example: 60000
                                date_added_at:
                                  type: object
                                  properties:
                                    unix:
                                      type: integer
                                      example: 1730399460
                                    iso:
                                      type: string
                                      example: '2024-10-31T13:11:00+03:00'
                                  oneOf:
                                    - type: object
                                      properties:
                                        unix:
                                          type: integer
                                          example: 1730399460
                                        iso:
                                          type: string
                                          example: '2024-10-31T13:11:00+03:00'
                                    - type: object
                                      properties:
                                        unix:
                                          type: 'null'
                                        iso:
                                          type: 'null'
                                last_activity_at:
                                  type: object
                                  properties:
                                    unix:
                                      type: integer
                                      example: 1730399460
                                    iso:
                                      type: string
                                      example: '2024-10-31T13:11:00+03:00'
                                  oneOf:
                                    - type: object
                                      properties:
                                        unix:
                                          type: integer
                                          example: 1730399460
                                        iso:
                                          type: string
                                          example: '2024-10-31T13:11:00+03:00'
                                    - type: object
                                      properties:
                                        unix:
                                          type: 'null'
                                        iso:
                                          type: 'null'
                                registered_at:
                                  type: object
                                  properties:
                                    unix:
                                      type: integer
                                      example: 1730399460
                                    iso:
                                      type: string
                                      example: '2024-10-31T13:11:00+03:00'
                                  oneOf:
                                    - type: object
                                      properties:
                                        unix:
                                          type: integer
                                          example: 1730399460
                                        iso:
                                          type: string
                                          example: '2024-10-31T13:11:00+03:00'
                                    - type: object
                                      properties:
                                        unix:
                                          type: 'null'
                                        iso:
                                          type: 'null'
                                progress_percent:
                                  type: integer
                                  minimum: 0
                                  maximum: 100
                                user:
                                  type: object
                                  properties:
                                    id:
                                      type: integer
                                    name:
                                      type: string
                                    email:
                                      type: string
                                      format: email
                                    phone:
                                      type: string
                                    department:
                                      type: string
                                    position:
                                      type: string
                          pagination:
                            type: object
                            properties:
                              page:
                                type: integer
                                example: 1
                              per_page:
                                type: integer
                                example: 200
                              total:
                                type: integer
                                example: 8
                              total_pages:
                                type: integer
                                example: 1
              examples:
                sample:
                  summary: Пример успешного ответа
                  value:
                    success: true
                    data:
                      filters:
                        product:
                          - 59
                          - 62
                        progress_from: 50
                        progress_to: 85
                        fields:
                          email:
                            - ya.ru
                      items:
                        - product:
                            id: 59
                            title: Цифровые коммуникации
                          status:
                            code: 4
                            name: Оплачен
                          amount: 60000
                          date_added_at:
                            unix: 1730399460
                            iso: '2024-10-31T13:11:00+03:00'
                          last_activity_at:
                            unix: null
                            iso: null
                          registered_at:
                            unix: 1698747060
                            iso: '2023-10-31T13:11:00+03:00'
                          progress_percent: 72
                          user:
                            id: 215
                            name: Георгий
                            email: poooga@ya.ru
                            phone: '+79999999952'
                            department: Отдел разработки
                            position: Директор по продукту
                      pagination:
                        page: 1
                        per_page: 200
                        total: 8
                        total_pages: 1
        '400':
          description: Ошибка в запросе (неверные параметры)
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  email:
                    - Некорректный email
                  page:
                    - page must be >= 1
        '403':
          description: Доступ запрещен (недостаточно прав)
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  errors:
                    type: object
                    description: Ошибки валидации по полям
                    example:
                      email:
                        - Email already taken.
                      password:
                        - Password minimum 6 characters.
              example:
                success: false
                errors:
                  access:
                    - Недостаточно прав для выполнения операции
components:
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-Key
  schemas:
    UserForm:
      allOf:
        - type: object
          required:
            - username
            - email
          properties:
            username:
              type: string
              minLength: 2
              maxLength: 255
              description: |
                Имя пользователя. Обязательное поле.
                - Минимум 2 символа
                - Максимум 255 символов
                - Trim automatically applied
              example: Иван Петров
            email:
              type: string
              format: email
              description: |
                Email пользователя. Должен быть уникальным в системе.
                - Trim automatically applied
                - Valid email format required
              example: ivan.petrov@example.com
            password:
              type: string
              description: |
                Пароль пользователя. Если не указан, генерируется автоматически.
                - Для существующих сотрудников не требуется
                - Для новых пользователей рекомендуется задавать
              example: SecurePassword123!
            role:
              type: string
              description: |
                Роль пользователя в системе. По умолчанию 'user'.
                - Не может быть из списка RESTRICTED_ROLES
                - Доступные роли: superadmin, admin, editor, curator, student
              example: student
              enum:
                - superadmin
                - admin
                - editor
                - curator
                - student
            department:
              type: string
              description: |
                Отдел пользователя. Синхронизируется с LMS.
              example: IT отдел
            position:
              type: string
              description: |
                Должность пользователя. Синхронизируется с LMS.
              example: Разработчик
            phone:
              type: string
              description: |
                Телефон пользователя
              example: +7 (999) 123-45-67
            custom_fields:
              type: object
              description: |
                Дополнительные поля пользователя (custom fields)
                Ключи - это имена полей, значения - данные
              example:
                city: Москва
                experience: 5 лет
                skills:
                  - PHP
                  - JavaScript
                  - MySQL
            group_ids:
              type: array
              description: Список идентификаторов групп, к которым добавляется пользователь
              items:
                type: integer
                minimum: 1
              example:
                - 12
                - 34
            course_ids:
              type: array
              description: Список идентификаторов курсов для назначения
              items:
                type: integer
                minimum: 1
              example:
                - 501
                - 502
        - type: object
          properties:
            id:
              type: integer
              minimum: 1
              example: 101
              description: ID пользователя (только для update)
            avatar:
              type: string
              format: binary
              description: Аватар пользователя (опционально)
    CreateUserRequest:
      type: object
      required:
        - username
        - email
      properties:
        username:
          type: string
          minLength: 2
          maxLength: 255
          description: |
            Имя пользователя. Обязательное поле.
            - Минимум 2 символа
            - Максимум 255 символов
            - Trim automatically applied
          example: Иван Петров
        email:
          type: string
          format: email
          description: |
            Email пользователя. Должен быть уникальным в системе.
            - Trim automatically applied
            - Valid email format required
          example: ivan.petrov@example.com
        password:
          type: string
          description: |
            Пароль пользователя. Если не указан, генерируется автоматически.
            - Для существующих сотрудников не требуется
            - Для новых пользователей рекомендуется задавать
          example: SecurePassword123!
        role:
          type: string
          description: |
            Роль пользователя в системе. По умолчанию 'user'.
            - Не может быть из списка RESTRICTED_ROLES
            - Доступные роли: superadmin, admin, editor, curator, student
          example: student
          enum:
            - superadmin
            - admin
            - editor
            - curator
            - student
        department:
          type: string
          description: |
            Отдел пользователя. Синхронизируется с LMS.
          example: IT отдел
        position:
          type: string
          description: |
            Должность пользователя. Синхронизируется с LMS.
          example: Разработчик
        phone:
          type: string
          description: |
            Телефон пользователя
          example: +7 (999) 123-45-67
        custom_fields:
          type: object
          description: |
            Дополнительные поля пользователя (custom fields)
            Ключи - это имена полей, значения - данные
          example:
            city: Москва
            experience: 5 лет
            skills:
              - PHP
              - JavaScript
              - MySQL
        group_ids:
          type: array
          description: Список идентификаторов групп, к которым добавляется пользователь
          items:
            type: integer
            minimum: 1
          example:
            - 12
            - 34
        course_ids:
          type: array
          description: Список идентификаторов курсов для назначения
          items:
            type: integer
            minimum: 1
          example:
            - 501
            - 502
    User:
      type: object
      properties:
        id:
          type: integer
          example: 137
        email:
          type: string
          format: email
          example: user@example.com
        name:
          type: string
          example: Иван Иванов
        role:
          type: string
          enum:
            - admin
            - editor
            - curator
            - student
          x-enumDescriptions:
            admin: Администратор (полный доступ)
            editor: Контент-редактор
            curator: Куратор/методист
            student: Ученик/слушатель
          example: student
        status:
          type: string
          enum:
            - active
            - inactive
            - blocked
          x-enumDescriptions:
            active: Активный пользователь
            inactive: Неактивный (архив/черновик)
            blocked: Заблокирован (без доступа)
          example: active
        created_at:
          type: string
          format: date-time
          example: '2024-01-15T10:30:00Z'
        updated_at:
          type: string
          format: date-time
          example: '2024-01-15T10:30:00Z'
    UserList:
      type: object
      properties:
        data:
          type: array
          items:
            type: object
            properties:
              id:
                type: integer
                description: Уникальный идентификатор пользователя
                example: 123
              username:
                type: string
                description: Имя пользователя
                example: Иван Петров
              email:
                type: string
                format: email
                description: Email пользователя
                example: ivan.petrov@example.com
              role:
                type: string
                description: Роль пользователя
                example: student
              status:
                type: string
                description: Статус пользователя
                enum:
                  - active
                  - inactive
                  - blocked
                example: active
              department:
                type: string
                description: Отдел
                example: IT отдел
              position:
                type: string
                description: Должность
                example: Разработчик
              phone:
                type: string
                description: Телефон
                example: +7 (999) 123-45-67
              photo:
                type: string
                format: uri
                description: URL фотографии пользователя (S3)
                example: https://s3.amazonaws.com/bucket/users/photos/123.jpg
              created_at:
                type: string
                format: date-time
                description: Дата создания пользователя
                example: '2025-01-15T10:30:00Z'
              updated_at:
                type: string
                format: date-time
                description: Дата последнего обновления
                example: '2025-01-15T10:30:00Z'
              last_login_at:
                type: string
                format: date-time
                description: Дата последнего входа
                example: '2025-01-16T09:15:00Z'
              email_verified:
                type: boolean
                description: Подтвержден ли email
                example: true
              custom_fields:
                type: object
                description: Дополнительные поля пользователя
                example:
                  city: Москва
                  experience: 5 лет
          description: Массив пользователей
        meta:
          type: object
          properties:
            total:
              type: integer
              description: Общее количество элементов
              example: 150
            page:
              type: integer
              description: Текущая страница
              example: 1
            per-page:
              type: integer
              description: Элементов на странице
              example: 20
    UserImportStatus:
      type: object
      properties:
        id:
          type: integer
          description: ID задачи импорта
          example: 456
        status:
          type: string
          enum:
            - pending
            - processing
            - completed
            - failed
          description: Статус обработки
          example: processing
        progress:
          type: integer
          minimum: 0
          maximum: 100
          description: Прогресс выполнения в процентах
          example: 75
        total_rows:
          type: integer
          description: Всего строк в файле
          example: 150
        processed_rows:
          type: integer
          description: Обработано строк
          example: 112
        errors:
          type: array
          items:
            type: object
            properties:
              row:
                type: integer
                description: Номер строки с ошибкой
              field:
                type: string
                description: Поле с ошибкой
              message:
                type: string
                description: Описание ошибки
          description: Массив ошибок валидации
        created_at:
          type: string
          format: date-time
          description: Время создания задачи
        completed_at:
          type: string
          format: date-time
          description: Время завершения задачи
    ImportReport:
      type: object
      description: Итоговый отчёт завершённого импорта пользователей
      properties:
        id:
          type: integer
          description: ID отчёта импорта
          example: 1201
        file:
          type: string
          description: Имя исходного файла импорта
          example: import-users-2025-02-10.xlsx
        status:
          type: string
          enum:
            - completed
            - failed
          description: Финальный статус задачи импорта
          example: completed
        progress:
          type: integer
          minimum: 0
          maximum: 100
          description: Процент завершения задачи (всегда 100 для завершённых отчётов)
          example: 100
        success_count:
          type: integer
          description: Количество успешно обработанных записей
          example: 118
        error_count:
          type: integer
          description: Количество записей с ошибками
          example: 2
        created_at:
          type: string
          format: date-time
          description: Дата создания задачи импорта
          example: '2025-02-10T10:00:00Z'
        updated_at:
          type: string
          format: date-time
          description: Дата последнего обновления статуса задачи
          example: '2025-02-10T10:05:30Z'
    UserField:
      type: object
      properties:
        id:
          type: integer
          description: ID поля
          example: 789
        name:
          type: string
          description: Имя поля (system name)
          example: experience_years
        label:
          type: string
          description: Отображаемое название поля
          example: Опыт работы (лет)
        type:
          type: string
          enum:
            - string
            - number
            - date
            - boolean
            - select
          description: Тип поля
          example: number
        required:
          type: boolean
          description: Обязательное ли поле
          example: false
        enabled:
          type: boolean
          description: Активно ли поле
          example: true
        validation_rules:
          type: object
          description: Правила валидации
          example:
            min: 0
            max: 50
        options:
          type: array
          items:
            type: string
          description: Варианты для select полей
          example:
            - 0-1
            - 2-5
            - 6-10
            - 10+
    UserStatus:
      type: object
      properties:
        id:
          type: string
          description: Системный код статуса
          example: active
        name:
          type: string
          description: Отображаемое название статуса
          example: Активный
        description:
          type: string
          description: Расширенное описание статуса
          example: Пользователь с активной учётной записью
        category:
          type: string
          description: Группа статусов (например, access, pending, blocked)
          example: access
        color:
          type: string
          description: Цветовой код статуса (hex)
          example: '#2ea44f'
        is_default:
          type: boolean
          description: Является ли статус статусом по умолчанию при создании
          example: true
      example:
        id: active
        name: Активный
        description: Пользователь с полной активной учётной записью
        category: access
        color: '#2ea44f'
        is_default: true
    Group:
      type: object
      properties:
        id:
          type: integer
          example: 1
        name:
          type: string
          example: Отдел продаж
        description:
          type: string
          example: Сотрудники отдела продаж
        parent_id:
          oneOf:
            - type: integer
              minimum: 1
            - type: 'null'
          example: null
        members_count:
          type: integer
          example: 25
        hierarchy_level:
          type: integer
          example: 0
        created_at:
          type: string
          format: date-time
          example: '2024-01-15T10:30:00Z'
    GroupListItem:
      allOf:
        - type: object
          properties:
            id:
              type: integer
              description: Уникальный идентификатор группы
              example: 1
            name:
              type: string
              description: Название группы
              example: IT Department
            comment:
              type: string
              description: Описание группы
              example: Разработка и поддержка IT систем
            hierarchyPathString:
              type: string
              description: Полный иерархический путь группы
              example: Company / IT Department / Development Team
            userCount:
              type: integer
              description: Количество пользователей в группе
              example: 25
            type:
              type: integer
              description: Тип группы (1=гостевая, 2=авторизованных, 9=по умолчанию)
              example: 2
            parent_id:
              oneOf:
                - type: integer
                  minimum: 1
                - type: 'null'
              description: ID родительской группы
              example: null
            image:
              oneOf:
                - type: string
                  format: uri
                - type: 'null'
              description: URL изображения группы
              example: https://s3.reezonly.com/groups/it-dept.jpg
            created_at:
              type: string
              format: date-time
              description: Дата создания
              example: '2023-08-25T14:15:43Z'
            updated_at:
              type: string
              format: date-time
              description: Дата обновления
              example: '2023-08-25T14:15:43Z'
        - type: object
          properties:
            parent:
              oneOf:
                - type: object
                  description: Информация о родительской группе
                  properties:
                    id:
                      type: integer
                      example: 1
                    name:
                      type: string
                      example: IT Department
                - type: 'null'
    GroupDetail:
      allOf:
        - type: object
          properties:
            id:
              type: integer
              description: Уникальный идентификатор группы
              example: 1
            name:
              type: string
              description: Название группы
              example: IT Department
            comment:
              type: string
              description: Описание группы
              example: Разработка и поддержка IT систем
            hierarchyPathString:
              type: string
              description: Полный иерархический путь группы
              example: Company / IT Department / Development Team
            userCount:
              type: integer
              description: Количество пользователей в группе
              example: 25
            type:
              type: integer
              description: Тип группы (1=гостевая, 2=авторизованных, 9=по умолчанию)
              example: 2
            parent_id:
              oneOf:
                - type: integer
                  minimum: 1
                - type: 'null'
              description: ID родительской группы
              example: null
            image:
              oneOf:
                - type: string
                  format: uri
                - type: 'null'
              description: URL изображения группы
              example: https://s3.reezonly.com/groups/it-dept.jpg
            created_at:
              type: string
              format: date-time
              description: Дата создания
              example: '2023-08-25T14:15:43Z'
            updated_at:
              type: string
              format: date-time
              description: Дата обновления
              example: '2023-08-25T14:15:43Z'
        - type: object
          properties:
            users:
              type: array
              description: Список пользователей группы
              items:
                allOf:
                  - type: object
                    properties:
                      id:
                        type: integer
                        example: 137
                      email:
                        type: string
                        format: email
                        example: user@example.com
                      name:
                        type: string
                        example: Иван Иванов
                      role:
                        type: string
                        enum:
                          - admin
                          - editor
                          - curator
                          - student
                        x-enumDescriptions:
                          admin: Администратор (полный доступ)
                          editor: Контент-редактор
                          curator: Куратор/методист
                          student: Ученик/слушатель
                        example: student
                      status:
                        type: string
                        enum:
                          - active
                          - inactive
                          - blocked
                        x-enumDescriptions:
                          active: Активный пользователь
                          inactive: Неактивный (архив/черновик)
                          blocked: Заблокирован (без доступа)
                        example: active
                      created_at:
                        type: string
                        format: date-time
                        example: '2024-01-15T10:30:00Z'
                      updated_at:
                        type: string
                        format: date-time
                        example: '2024-01-15T10:30:00Z'
                  - type: object
                    properties:
                      role_in_group:
                        type: string
                        description: Роль пользователя в группе
                        example: member
                      joined_at:
                        type: string
                        format: date-time
                        description: Дата добавления в группу
                        example: '2023-09-01T10:00:00Z'
            children:
              type: array
              description: Дочерние группы
              items:
                allOf:
                  - type: object
                    properties:
                      id:
                        type: integer
                        description: Уникальный идентификатор группы
                        example: 1
                      name:
                        type: string
                        description: Название группы
                        example: IT Department
                      comment:
                        type: string
                        description: Описание группы
                        example: Разработка и поддержка IT систем
                      hierarchyPathString:
                        type: string
                        description: Полный иерархический путь группы
                        example: Company / IT Department / Development Team
                      userCount:
                        type: integer
                        description: Количество пользователей в группе
                        example: 25
                      type:
                        type: integer
                        description: Тип группы (1=гостевая, 2=авторизованных, 9=по умолчанию)
                        example: 2
                      parent_id:
                        oneOf:
                          - type: integer
                            minimum: 1
                          - type: 'null'
                        description: ID родительской группы
                        example: null
                      image:
                        oneOf:
                          - type: string
                            format: uri
                          - type: 'null'
                        description: URL изображения группы
                        example: https://s3.reezonly.com/groups/it-dept.jpg
                      created_at:
                        type: string
                        format: date-time
                        description: Дата создания
                        example: '2023-08-25T14:15:43Z'
                      updated_at:
                        type: string
                        format: date-time
                        description: Дата обновления
                        example: '2023-08-25T14:15:43Z'
                  - type: object
                    properties:
                      parent:
                        oneOf:
                          - type: object
                            description: Информация о родительской группе
                            properties:
                              id:
                                type: integer
                                example: 1
                              name:
                                type: string
                                example: IT Department
                          - type: 'null'
            rules:
              type: array
              description: Правила доступа группы
              items:
                type: object
                properties:
                  type:
                    type: integer
                    example: 1
                  objectId:
                    type: integer
                    example: 42
                  objectType:
                    type: string
                    example: course
    GroupHierarchyItem:
      type: object
      properties:
        id:
          type: integer
          description: ID группы
          example: 1
        name:
          type: string
          description: Название группы
        parent_id:
          oneOf:
            - type: integer
            - type: 'null'
          description: ID родительской группы
        level:
          type: integer
          description: Уровень вложенности (0=корневой)
          example: 0
        has_children:
          type: boolean
          description: Наличие дочерних групп
          example: true
        userCount:
          type: integer
          description: Количество пользователей
          example: 15
    CreateGroupRequest:
      type: object
      required:
        - name
      properties:
        name:
          type: string
          minLength: 2
          maxLength: 255
          description: Название группы (обязательное поле)
          example: Marketing Department
        comment:
          type: string
          maxLength: 512
          description: Описание группы (опционально)
          example: Отдел маркетинга и продвижения
        parent_id:
          oneOf:
            - type: integer
              minimum: 1
            - type: 'null'
          description: |
            ID родительской группы:
            - `null` для корневой группы
            - ID существующей группы для дочерней
          example: null
        user_ids:
          type: array
          items:
            type: integer
            minimum: 1
          maxItems: 100
          description: Пользователи для добавления в группу
          example:
            - 101
            - 102
        image_upload:
          type: string
          format: binary
          description: Файл изображения группы (через multipart/form-data)
    GroupForm:
      allOf:
        - type: object
          required:
            - name
          properties:
            name:
              type: string
              minLength: 2
              maxLength: 255
              description: Название группы (обязательное поле)
              example: Marketing Department
            comment:
              type: string
              maxLength: 512
              description: Описание группы (опционально)
              example: Отдел маркетинга и продвижения
            parent_id:
              oneOf:
                - type: integer
                  minimum: 1
                - type: 'null'
              description: |
                ID родительской группы:
                - `null` для корневой группы
                - ID существующей группы для дочерней
              example: null
            user_ids:
              type: array
              items:
                type: integer
                minimum: 1
              maxItems: 100
              description: Пользователи для добавления в группу
              example:
                - 101
                - 102
            image_upload:
              type: string
              format: binary
              description: Файл изображения группы (через multipart/form-data)
        - type: object
          properties:
            name:
              type: string
              description: Название группы
              example: Support
            comment:
              type: string
              description: Описание группы
              example: Группа поддержки
            parent_id:
              oneOf:
                - type: integer
                  minimum: 1
                - type: 'null'
              description: ID родительской группы
            user_ids:
              type: array
              items:
                type: integer
                minimum: 1
              description: Пользователи для добавления
            image_upload:
              type: string
              format: binary
              description: Изображение группы (multipart/form-data)
    UsersGroupsFrom:
      type: object
      description: Пакетное добавление/удаление пользователей в группах через multipart/form-data
      required:
        - groupIds
        - userIds
      properties:
        groupIds:
          type: array
          items:
            type: integer
            minimum: 1
          minItems: 1
          maxItems: 10
          description: ID групп для операции
          example:
            - 2
            - 5
        userIds:
          type: array
          items:
            type: integer
            minimum: 1
          minItems: 1
          maxItems: 100
          description: ID пользователей для добавления/удаления
          example:
            - 101
            - 102
            - 103
        role:
          type: string
          enum:
            - superadmin
            - admin
            - editor
            - curator
            - student
          description: Роль пользователя в группе (опционально, используется при добавлении)
          example: editor
    GroupCourseForm:
      type: object
      description: Назначение курсов всем пользователям группы (multipart/form-data)
      required:
        - group_id
        - course_ids
      properties:
        group_id:
          type: integer
          minimum: 1
          description: ID группы, для которой назначаются курсы
          example: 12
        course_ids:
          type: array
          items:
            type: integer
            minimum: 1
          minItems: 1
          maxItems: 50
          description: Идентификаторы курсов для назначения
          example:
            - 501
            - 502
            - 503
    UserGroupOperationRequest:
      oneOf:
        - type: object
          description: Операция с одной группой
          required:
            - id
            - userIds
          properties:
            id:
              type: integer
              minimum: 1
              description: ID группы
              example: 10
            userIds:
              type: array
              items:
                type: integer
                minimum: 1
              maxItems: 100
              description: Массив ID пользователей (максимум 100)
              example:
                - 501
                - 502
        - type: object
          description: Операция с несколькими группами
          required:
            - userIds
            - groupIds
          properties:
            userIds:
              type: array
              items:
                type: integer
                minimum: 1
              maxItems: 100
              description: Массив ID пользователей (максимум 100)
              example:
                - 501
                - 502
            groupIds:
              type: array
              items:
                type: integer
                minimum: 1
              maxItems: 10
              description: Массив ID групп (максимум 10)
              example:
                - 12
                - 15
    GroupMemberStats:
      type: object
      properties:
        count:
          type: integer
          description: Общее количество участников
          example: 25
        active_count:
          type: integer
          description: Количество активных участников
          example: 22
        inactive_count:
          type: integer
          description: Количество неактивных участников
          example: 3
        subgroup_users:
          type: integer
          description: Количество пользователей из дочерних групп (если include_subgroups=true)
          example: 15
        last_updated:
          type: string
          format: date-time
          description: Время последнего обновления статистики
          example: '2023-11-19T10:30:00Z'
    PageType:
      type: object
      properties:
        id:
          type: integer
          example: 3
        name:
          type: string
          example: product-page
    DictionaryPage:
      type: object
      properties:
        id:
          type: integer
          example: 12
        alias:
          type: string
          example: product-page-42
        title:
          type: string
          example: Курс "Data Science"
        description:
          type: string
          example: Лендинг продукта Data Science
        enabled:
          type: boolean
          example: true
        type:
          type: string
          description: Тип страницы (используйте справочник page-types)
          example: course-and-training-promo-page
    SuccessResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        meta:
          type: object
          properties:
            total:
              type: integer
              description: Общее количество элементов
              example: 150
            page:
              type: integer
              description: Текущая страница
              example: 1
            per-page:
              type: integer
              description: Элементов на странице
              example: 20
    ErrorResponse:
      type: object
      properties:
        success:
          type: boolean
          example: false
        errors:
          type: object
          description: Ошибки валидации по полям
          example:
            email:
              - Email already taken.
            password:
              - Password minimum 6 characters.
    PaginationMeta:
      type: object
      properties:
        total:
          type: integer
          description: Общее количество элементов
          example: 150
        page:
          type: integer
          description: Текущая страница
          example: 1
        per-page:
          type: integer
          description: Элементов на странице
          example: 20
    Certificate:
      type: object
      properties:
        id:
          type: integer
          example: 1
        title:
          type: string
          example: Сертификат о прохождении курса
        description:
          type: string
          example: Выдан за успешное завершение курса
        issued_at:
          type: string
          format: date-time
          example: '2024-01-15T10:30:00Z'
        status:
          type: string
          enum:
            - issued
            - revoked
            - expired
          x-enumDescriptions:
            issued: Сертификат выдан
            revoked: Сертификат отозван
            expired: Срок действия истёк
          example: issued
    CertificateTemplate:
      type: object
      properties:
        id:
          type: integer
          example: 3
        name:
          type: string
          description: Название шаблона сертификата
          example: Standard Completion
        description:
          type: string
          description: Краткое описание шаблона
          example: Базовый шаблон для завершения курса
        file_url:
          type: string
          format: uri
          description: Ссылка на файл шаблона (PDF/DOCX)
          example: https://cdn.space.com/cert-templates/standard.pdf
        preview_url:
          type: string
          format: uri
          description: Превью изображения шаблона
          example: https://cdn.space.com/cert-templates/standard.png
        created_at:
          type: string
          format: date-time
          example: '2024-12-01T10:00:00Z'
        updated_at:
          type: string
          format: date-time
          example: '2024-12-15T15:30:00Z'
    CertificateDetail:
      allOf:
        - type: object
          properties:
            id:
              type: integer
              example: 1
            title:
              type: string
              example: Сертификат о прохождении курса
            description:
              type: string
              example: Выдан за успешное завершение курса
            issued_at:
              type: string
              format: date-time
              example: '2024-01-15T10:30:00Z'
            status:
              type: string
              enum:
                - issued
                - revoked
                - expired
              x-enumDescriptions:
                issued: Сертификат выдан
                revoked: Сертификат отозван
                expired: Срок действия истёк
              example: issued
        - type: object
          properties:
            user:
              type: object
              properties:
                id:
                  type: integer
                  example: 137
                email:
                  type: string
                  format: email
                  example: user@example.com
                name:
                  type: string
                  example: Иван Иванов
                role:
                  type: string
                  enum:
                    - admin
                    - editor
                    - curator
                    - student
                  x-enumDescriptions:
                    admin: Администратор (полный доступ)
                    editor: Контент-редактор
                    curator: Куратор/методист
                    student: Ученик/слушатель
                  example: student
                status:
                  type: string
                  enum:
                    - active
                    - inactive
                    - blocked
                  x-enumDescriptions:
                    active: Активный пользователь
                    inactive: Неактивный (архив/черновик)
                    blocked: Заблокирован (без доступа)
                  example: active
                created_at:
                  type: string
                  format: date-time
                  example: '2024-01-15T10:30:00Z'
                updated_at:
                  type: string
                  format: date-time
                  example: '2024-01-15T10:30:00Z'
            course:
              type: object
              properties:
                id:
                  type: integer
                  example: 480
                title:
                  type: string
                  example: Data Analytics 101
            template:
              type: object
              properties:
                id:
                  type: integer
                  example: 3
                name:
                  type: string
                  description: Название шаблона сертификата
                  example: Standard Completion
                description:
                  type: string
                  description: Краткое описание шаблона
                  example: Базовый шаблон для завершения курса
                file_url:
                  type: string
                  format: uri
                  description: Ссылка на файл шаблона (PDF/DOCX)
                  example: https://cdn.space.com/cert-templates/standard.pdf
                preview_url:
                  type: string
                  format: uri
                  description: Превью изображения шаблона
                  example: https://cdn.space.com/cert-templates/standard.png
                created_at:
                  type: string
                  format: date-time
                  example: '2024-12-01T10:00:00Z'
                updated_at:
                  type: string
                  format: date-time
                  example: '2024-12-15T15:30:00Z'
            download_url:
              type: string
              format: uri
              description: Ссылка на скачивание PDF сертификата
              example: https://cdn.space.com/certificates/CERT-2025-0001.pdf
    DateValue:
      type: object
      properties:
        unix:
          type: integer
          example: 1730399460
        iso:
          type: string
          example: '2024-10-31T13:11:00+03:00'
      oneOf:
        - type: object
          properties:
            unix:
              type: integer
              example: 1730399460
            iso:
              type: string
              example: '2024-10-31T13:11:00+03:00'
        - type: object
          properties:
            unix:
              type: 'null'
            iso:
              type: 'null'
    ImportStatus:
      type: object
      properties:
        id:
          type: string
          example: import_123456
        status:
          type: string
          enum:
            - pending
            - processing
            - completed
            - failed
          x-enumDescriptions:
            pending: Задача создана, ожидает запуска
            processing: Импорт выполняется
            completed: Импорт успешно завершён
            failed: Импорт завершился ошибкой
          example: processing
        progress:
          type: object
          properties:
            total:
              type: integer
              example: 1000
            processed:
              type: integer
              example: 650
            errors:
              type: integer
              example: 5
        started_at:
          type: string
          format: date-time
          example: '2024-01-15T10:30:00Z'
        estimated_completion:
          type: string
          format: date-time
          example: '2024-01-15T11:00:00Z'
    Course:
      type: object
      properties:
        id:
          type: integer
          example: 101
        title:
          type: string
          example: Онбординг
        description:
          type: string
          example: Базовый курс для новых сотрудников
        status:
          type: string
          enum:
            - draft
            - active
            - archived
          example: active
        price:
          type: number
          format: float
          example: 0
        duration:
          type: string
          description: Продолжительность в удобном формате
          example: 2h
        level:
          type: string
          enum:
            - beginner
            - intermediate
            - advanced
          example: beginner
        category:
          type: object
          properties:
            id:
              type: integer
              example: 5
            name:
              type: string
              example: Корпоративное обучение
        instructor:
          type: object
          properties:
            id:
              type: integer
              example: 77
            name:
              type: string
              example: Анна Смирнова
            avatar_url:
              type: string
              format: uri
              example: https://cdn.space/instructors/77.png
        thumbnail_url:
          type: string
          format: uri
          example: https://cdn.space/courses/101.png
        lms_id:
          type: integer
          example: 501
    CourseDetail:
      allOf:
        - type: object
          properties:
            id:
              type: integer
              example: 101
            title:
              type: string
              example: Онбординг
            description:
              type: string
              example: Базовый курс для новых сотрудников
            status:
              type: string
              enum:
                - draft
                - active
                - archived
              example: active
            price:
              type: number
              format: float
              example: 0
            duration:
              type: string
              description: Продолжительность в удобном формате
              example: 2h
            level:
              type: string
              enum:
                - beginner
                - intermediate
                - advanced
              example: beginner
            category:
              type: object
              properties:
                id:
                  type: integer
                  example: 5
                name:
                  type: string
                  example: Корпоративное обучение
            instructor:
              type: object
              properties:
                id:
                  type: integer
                  example: 77
                name:
                  type: string
                  example: Анна Смирнова
                avatar_url:
                  type: string
                  format: uri
                  example: https://cdn.space/instructors/77.png
            thumbnail_url:
              type: string
              format: uri
              example: https://cdn.space/courses/101.png
            lms_id:
              type: integer
              example: 501
        - type: object
          properties:
            syllabus:
              type: array
              description: Список модулей/уроков
              items:
                type: object
                properties:
                  id:
                    type: integer
                    example: 1
                  title:
                    type: string
                    example: Введение
                  description:
                    type: string
                    example: Как работать в системе
                  duration:
                    type: string
                    example: 10m
    FileUploadResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        file_id:
          type: string
          example: file_abc123
        filename:
          type: string
          example: users_import.xlsx
        size:
          type: integer
          example: 25600
        mime_type:
          type: string
          example: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet
  parameters:
    Page:
      in: query
      name: page
      description: Номер страницы для пагинации
      required: false
      schema:
        type: integer
        minimum: 1
        default: 1
        example: 1
    PerPage:
      in: query
      name: per-page
      description: Количество элементов на странице (максимум 100)
      required: false
      schema:
        type: integer
        minimum: 1
        maximum: 100
        default: 20
        example: 50
    Search:
      in: query
      name: search
      description: Поисковый запрос для фильтрации результатов
      required: false
      schema:
        type: string
        example: ivan
    Id:
      in: query
      name: id
      description: Идентификатор ресурса
      required: true
      schema:
        type: integer
        minimum: 1
        example: 42
    PathId:
      in: path
      name: id
      description: Идентификатор ресурса в URL пути
      required: true
      schema:
        type: integer
        minimum: 1
        example: 42
    Ids:
      in: query
      name: ids[]
      description: Массив идентификаторов для массовых операций (максимум 100 элементов)
      required: true
      schema:
        type: array
        items:
          type: integer
          minimum: 1
        maxItems: 100
        example:
          - 12
          - 15
          - 20
    ParentId:
      in: query
      name: parent_id
      description: ID родительского элемента (null для корневого уровня)
      required: false
      schema:
        oneOf:
          - type: integer
            minimum: 1
          - type: 'null'
        example: null
    ShowDefault:
      in: query
      name: showDefault
      description: Показать стандартные элементы (0|1)
      required: false
      schema:
        type: integer
        enum:
          - 0
          - 1
        default: 0
        example: 1
  responses:
    Success:
      description: Успешное выполнение операции
      content:
        application/json:
          schema:
            allOf:
              - type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  meta:
                    type: object
                    properties:
                      total:
                        type: integer
                        description: Общее количество элементов
                        example: 150
                      page:
                        type: integer
                        description: Текущая страница
                        example: 1
                      per-page:
                        type: integer
                        description: Элементов на странице
                        example: 20
              - type: object
                properties:
                  message:
                    type: string
                    example: Operation completed successfully
    Created:
      description: Ресурс успешно создан
      content:
        application/json:
          schema:
            allOf:
              - type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  meta:
                    type: object
                    properties:
                      total:
                        type: integer
                        description: Общее количество элементов
                        example: 150
                      page:
                        type: integer
                        description: Текущая страница
                        example: 1
                      per-page:
                        type: integer
                        description: Элементов на странице
                        example: 20
              - type: object
                properties:
                  message:
                    type: string
                    example: Resource created successfully
    UserList:
      description: Список пользователей успешно получен
      content:
        application/json:
          schema:
            allOf:
              - type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  meta:
                    type: object
                    properties:
                      total:
                        type: integer
                        description: Общее количество элементов
                        example: 150
                      page:
                        type: integer
                        description: Текущая страница
                        example: 1
                      per-page:
                        type: integer
                        description: Элементов на странице
                        example: 20
              - type: object
                properties:
                  data:
                    type: object
                    properties:
                      pagination:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: Общее количество элементов
                            example: 150
                          page:
                            type: integer
                            description: Текущая страница
                            example: 1
                          per-page:
                            type: integer
                            description: Элементов на странице
                            example: 20
                      items:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              example: 137
                            email:
                              type: string
                              format: email
                              example: user@example.com
                            name:
                              type: string
                              example: Иван Иванов
                            role:
                              type: string
                              enum:
                                - admin
                                - editor
                                - curator
                                - student
                              x-enumDescriptions:
                                admin: Администратор (полный доступ)
                                editor: Контент-редактор
                                curator: Куратор/методист
                                student: Ученик/слушатель
                              example: student
                            status:
                              type: string
                              enum:
                                - active
                                - inactive
                                - blocked
                              x-enumDescriptions:
                                active: Активный пользователь
                                inactive: Неактивный (архив/черновик)
                                blocked: Заблокирован (без доступа)
                              example: active
                            created_at:
                              type: string
                              format: date-time
                              example: '2024-01-15T10:30:00Z'
                            updated_at:
                              type: string
                              format: date-time
                              example: '2024-01-15T10:30:00Z'
    GroupList:
      description: Список групп успешно получен
      content:
        application/json:
          schema:
            allOf:
              - type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  meta:
                    type: object
                    properties:
                      total:
                        type: integer
                        description: Общее количество элементов
                        example: 150
                      page:
                        type: integer
                        description: Текущая страница
                        example: 1
                      per-page:
                        type: integer
                        description: Элементов на странице
                        example: 20
              - type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          example: 1
                        name:
                          type: string
                          example: Отдел продаж
                        description:
                          type: string
                          example: Сотрудники отдела продаж
                        parent_id:
                          oneOf:
                            - type: integer
                              minimum: 1
                            - type: 'null'
                          example: null
                        members_count:
                          type: integer
                          example: 25
                        hierarchy_level:
                          type: integer
                          example: 0
                        created_at:
                          type: string
                          format: date-time
                          example: '2024-01-15T10:30:00Z'
    CertificateList:
      description: Список сертификатов успешно получен
      content:
        application/json:
          schema:
            allOf:
              - type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  meta:
                    type: object
                    properties:
                      total:
                        type: integer
                        description: Общее количество элементов
                        example: 150
                      page:
                        type: integer
                        description: Текущая страница
                        example: 1
                      per-page:
                        type: integer
                        description: Элементов на странице
                        example: 20
              - type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          example: 1
                        title:
                          type: string
                          example: Сертификат о прохождении курса
                        description:
                          type: string
                          example: Выдан за успешное завершение курса
                        issued_at:
                          type: string
                          format: date-time
                          example: '2024-01-15T10:30:00Z'
                        status:
                          type: string
                          enum:
                            - issued
                            - revoked
                            - expired
                          x-enumDescriptions:
                            issued: Сертификат выдан
                            revoked: Сертификат отозван
                            expired: Срок действия истёк
                          example: issued
    BadRequest:
      description: Ошибка в запросе (неверные параметры)
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              errors:
                type: object
                description: Ошибки валидации по полям
                example:
                  email:
                    - Email already taken.
                  password:
                    - Password minimum 6 characters.
          example:
            success: false
            errors:
              email:
                - Некорректный email
              page:
                - page must be >= 1
    Unauthorized:
      description: Ошибка аутентификации (отсутствует или неверный API ключ)
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              errors:
                type: object
                description: Ошибки валидации по полям
                example:
                  email:
                    - Email already taken.
                  password:
                    - Password minimum 6 characters.
          example:
            success: false
            errors:
              api_key:
                - Неверный или отсутствующий X-API-Key
    Forbidden:
      description: Доступ запрещен (недостаточно прав)
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              errors:
                type: object
                description: Ошибки валидации по полям
                example:
                  email:
                    - Email already taken.
                  password:
                    - Password minimum 6 characters.
          example:
            success: false
            errors:
              access:
                - Недостаточно прав для выполнения операции
    NotFound:
      description: Ресурс не найден
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              errors:
                type: object
                description: Ошибки валидации по полям
                example:
                  email:
                    - Email already taken.
                  password:
                    - Password minimum 6 characters.
          example:
            success: false
            errors:
              id:
                - Ресурс не найден
    ValidationError:
      description: Ошибка валидации данных
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              errors:
                type: object
                description: Ошибки валидации по полям
                example:
                  email:
                    - Email already taken.
                  password:
                    - Password minimum 6 characters.
          example:
            success: false
            errors:
              password:
                - Password must be at least 6 characters
    InternalError:
      description: Внутренняя ошибка сервера
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              errors:
                type: object
                description: Ошибки валидации по полям
                example:
                  email:
                    - Email already taken.
                  password:
                    - Password minimum 6 characters.
          example:
            success: false
            errors:
              server:
                - Internal server error. Try again later
    TooManyRequests:
      description: Превышен лимит запросов
      headers:
        Retry-After:
          description: Через сколько секунд можно повторить запрос
          schema:
            type: integer
            example: 30
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              errors:
                type: object
                description: Ошибки валидации по полям
                example:
                  email:
                    - Email already taken.
                  password:
                    - Password minimum 6 characters.
          example:
            success: false
            errors:
              rate_limit:
                - Превышен лимит запросов. Повторите через 30 секунд
x-servers:
  - url: https://your-space-domain.com/api/v1
    description: Production
  - url: https://staging-space-domain.com/api/v1
    description: Staging
  - url: http://localhost:8080/api/v1
    description: Local
x-tagGroups:
  - name: Users
    title: User Management — 16 методов
    description: |-
      Раздел User Management предназначен для синхронизации пользователей между вашей CRM/ERP и платформой Space. Каждый пользователь имеет профиль с контактной информацией, роль доступа, статус и может быть участником групп и курсов.

      User представляет пользователя в системе Reezonly Space. Каждый пользователь имеет профиль с контактной информацией, роль доступа, статус и может быть участником групп и курсов.
    tags:
      - Users.Operations
      - Users.Courses
      - Users.Import
      - Users.Fields
  - name: Groups
    title: Groups — 12 методов
    description: |-
      Раздел Groups предназначен для управления иерархической структурой групп пользователей в системе Space. Группы могут иметь вложенность, что позволяет создавать сложные организационные структуры.

      Group представляет собой коллекцию пользователей с общей ролью или принадлежностью к отделу/проекту. Группы поддерживают иерархическую структуру с неограниченной вложенностью.
    tags:
      - Groups.Structure
      - Groups.Members
  - name: Certificates
    title: Certificates — 12 методов
    description: |-
      Раздел Certificates предназначен для управления PDF сертификатами, которые выдаются пользователям за прохождение курсов. Система поддерживает шаблоны сертификатов, массовую и индивидуальную выдачу, а также интеграцию с внешними системами верификации.

      Certificate представляет собой PDF документ, подтверждающий успешное завершение обучения. Каждый сертификат имеет уникальный номер, дату выдачи и может быть проверен через публичный интерфейс.
    tags:
      - Certificates.Templates
      - Certificates.Issued
      - Certificates.Lookups
  - name: Learning
    title: Learning — 4 метода (READ-ONLY)
    description: |-
      Раздел Learning предоставляет доступ к каталогу курсов и страниц контента в режиме чтения. Основной контент курсов хранится во внешней LMS системе, а Space выступает как витрина и система управления доступом.

      ⚠️ Важно: Эти методы доступны только для чтения. Изменение контента курсов и уроков выполняется через LMS, а не через этот API.
    tags:
      - Courses
      - Pages
  - name: Integration Reports
    title: Integration Reports — 1 метод
    description: Раздел Integration Reports предназначен для предоставления аналитических данных внешним системам. Этот модуль позволяет получать отчеты об интеграционной активности, результатах импорта и экспорта данных, а также ключевые метрики для мониторинга работы интеграций.
    tags:
      - Integration Reports
